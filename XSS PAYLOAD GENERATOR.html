<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XSS Scanner Pro - Security Research Tool</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --dark: #1f2937;
            --light: #f9fafb;
            --gray: #6b7280;
            --card-bg: #ffffff;
            --shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --radius: 12px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--dark);
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-top: 30px;
        }

        .header h1 {
            font-size: 3rem;
            font-weight: 700;
            background: linear-gradient(135deg, #ffffff 0%, #e0e7ff 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .header p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Main Layout */
        .main-layout {
            display: grid;
            grid-template-columns: 1fr 1.5fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        @media (max-width: 1024px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
        }

        /* Cards */
        .card {
            background: var(--card-bg);
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px -15px rgba(0, 0, 0, 0.2);
        }

        .card-title {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 25px;
            color: var(--dark);
            font-size: 1.5rem;
            font-weight: 600;
        }

        .card-title i {
            color: var(--primary);
            font-size: 1.3rem;
        }

        /* Input Section */
        .input-group {
            margin-bottom: 25px;
        }

        .input-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .input-field {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-family: 'Roboto Mono', monospace;
            font-size: 15px;
            transition: all 0.3s ease;
            background: #f8fafc;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--primary);
            background: white;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 14px 28px;
            border: none;
            border-radius: 10px;
            font-family: 'Poppins', sans-serif;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(99, 102, 241, 0.4);
        }

        .btn-secondary {
            background: var(--light);
            color: var(--dark);
            border: 2px solid #e5e7eb;
        }

        .btn-secondary:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger) 0%, #dc2626 100%);
            color: white;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(239, 68, 68, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--secondary) 0%, #059669 100%);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(16, 185, 129, 0.4);
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 25px;
        }

        /* Scanner Options */
        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .option-card {
            background: #f8fafc;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option-card:hover {
            border-color: var(--primary);
            background: white;
        }

        .option-card.selected {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.05);
        }

        .option-icon {
            font-size: 24px;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .option-title {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .option-desc {
            font-size: 13px;
            color: var(--gray);
        }

        /* Results Section */
        .results-container {
            margin-top: 40px;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .results-stats {
            display: flex;
            gap: 30px;
            background: white;
            padding: 20px;
            border-radius: var(--radius);
            margin-bottom: 25px;
            box-shadow: var(--shadow);
        }

        .stat {
            text-align: center;
            flex: 1;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--gray);
            font-size: 14px;
            font-weight: 500;
        }

        .stat-critical .stat-value { color: var(--danger); }
        .stat-high .stat-value { color: #f97316; }
        .stat-medium .stat-value { color: var(--warning); }
        .stat-low .stat-value { color: var(--secondary); }

        /* Vulnerabilities List */
        .vuln-list {
            background: white;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .vuln-item {
            padding: 25px;
            border-bottom: 1px solid #e5e7eb;
            transition: background 0.3s ease;
        }

        .vuln-item:hover {
            background: #f8fafc;
        }

        .vuln-item:last-child {
            border-bottom: none;
        }

        .vuln-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .vuln-title {
            font-weight: 600;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .vuln-severity {
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .severity-critical { background: #fee2e2; color: var(--danger); }
        .severity-high { background: #ffedd5; color: #f97316; }
        .severity-medium { background: #fef3c7; color: var(--warning); }
        .severity-low { background: #d1fae5; color: var(--secondary); }
        .severity-info { background: #e0e7ff; color: var(--primary); }

        .vuln-details {
            margin-top: 15px;
            padding: 15px;
            background: #f8fafc;
            border-radius: 8px;
            font-family: 'Roboto Mono', monospace;
            font-size: 14px;
            white-space: pre-wrap;
            word-break: break-all;
        }

        .vuln-payload {
            color: var(--primary-dark);
            font-weight: 500;
        }

        .vuln-url {
            color: var(--secondary);
            text-decoration: underline;
        }

        /* Progress Bar */
        .progress-container {
            background: #e5e7eb;
            border-radius: 10px;
            height: 12px;
            margin: 30px 0;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary) 0%, var(--secondary) 100%);
            border-radius: 10px;
            width: 0%;
            transition: width 0.5s ease;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            color: var(--gray);
            margin-top: 10px;
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 2px solid #e5e7eb;
            margin-bottom: 25px;
        }

        .tab {
            padding: 15px 25px;
            background: none;
            border: none;
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            color: var(--gray);
            cursor: pointer;
            position: relative;
            transition: color 0.3s ease;
        }

        .tab:hover {
            color: var(--dark);
        }

        .tab.active {
            color: var(--primary);
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--primary);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 40px 0;
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 60px;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 20px;
        }

        .footer-links a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-links a:hover {
            color: white;
        }

        /* Alert */
        .alert {
            padding: 20px;
            border-radius: var(--radius);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(-100px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .alert-warning {
            background: #fffbeb;
            border: 2px solid #f59e0b;
            color: #92400e;
        }

        .alert-info {
            background: #eff6ff;
            border: 2px solid var(--primary);
            color: #1e40af;
        }

        .alert-success {
            background: #d1fae5;
            border: 2px solid var(--secondary);
            color: #065f46;
        }

        .alert-danger {
            background: #fee2e2;
            border: 2px solid var(--danger);
            color: #991b1b;
        }

        /* Code Block */
        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Roboto Mono', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 20px 0;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 { font-size: 2.2rem; }
            .main-layout { gap: 20px; }
            .card { padding: 20px; }
            .btn-group { flex-direction: column; }
            .btn { width: 100%; }
            .results-stats { flex-direction: column; gap: 15px; }
            .stat-value { font-size: 2rem; }
        }

        /* Loading Animation */
        .loader {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 4px solid #e5e7eb;
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Dark Mode Toggle */
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        .theme-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .theme-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(30deg);
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 20px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            z-index: 1000;
            max-width: 400px;
            transform: translateX(150%);
            transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .notification-close {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: var(--gray);
        }
    </style>
</head>
<body>
    <!-- Theme Toggle -->
    <div class="theme-toggle">
        <button class="theme-btn" id="themeToggle">
            <i class="fas fa-moon"></i>
        </button>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <div class="notification-header">
            <strong id="notificationTitle">Notification</strong>
            <button class="notification-close" id="notificationClose">&times;</button>
        </div>
        <p id="notificationMessage">This is a notification message.</p>
    </div>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1><i class="fas fa-shield-alt"></i> XSS Scanner Pro</h1>
            <p>Advanced Cross-Site Scripting vulnerability scanner for security research and ethical hacking</p>
        </div>

        <!-- Alert Warning -->
        <div class="alert alert-warning">
            <i class="fas fa-exclamation-triangle"></i>
            <div>
                <strong>For Legal Use Only</strong> - This tool is for authorized security testing only.
                Never scan websites without permission.
            </div>
        </div>

        <!-- Main Layout -->
        <div class="main-layout">
            <!-- Left Panel: Configuration -->
            <div class="card">
                <div class="card-title">
                    <i class="fas fa-cogs"></i>
                    Scanner Configuration
                </div>

                <!-- Target Input -->
                <div class="input-group">
                    <label class="input-label">
                        <i class="fas fa-globe"></i>
                        Target URL
                    </label>
                    <input type="text" class="input-field" id="targetUrl" 
                           placeholder="https://example.com/page?param=value" 
                           value="http://testphp.vulnweb.com/search.php?test=query">
                </div>

                <!-- Scan Options -->
                <div class="input-group">
                    <label class="input-label">
                        <i class="fas fa-sliders-h"></i>
                        Scan Options
                    </label>
                    <div class="options-grid">
                        <div class="option-card selected" data-option="reflected">
                            <div class="option-icon"><i class="fas fa-redo"></i></div>
                            <div class="option-title">Reflected XSS</div>
                            <div class="option-desc">Test URL parameters</div>
                        </div>
                        <div class="option-card selected" data-option="stored">
                            <div class="option-icon"><i class="fas fa-database"></i></div>
                            <div class="option-title">Stored XSS</div>
                            <div class="option-desc">Test form inputs</div>
                        </div>
                        <div class="option-card selected" data-option="dom">
                            <div class="option-icon"><i class="fas fa-code"></i></div>
                            <div class="option-title">DOM XSS</div>
                            <div class="option-desc">Test client-side scripts</div>
                        </div>
                        <div class="option-card" data-option="blind">
                            <div class="option-icon"><i class="fas fa-eye-slash"></i></div>
                            <div class="option-title">Blind XSS</div>
                            <div class="option-desc">Test for delayed payloads</div>
                        </div>
                    </div>
                </div>

                <!-- Payload Options -->
                <div class="input-group">
                    <label class="input-label">
                        <i class="fas fa-bomb"></i>
                        Payload Intensity
                    </label>
                    <select class="input-field" id="payloadIntensity">
                        <option value="low">Low (Basic payloads)</option>
                        <option value="medium" selected>Medium (Standard payloads)</option>
                        <option value="high">High (Advanced payloads)</option>
                        <option value="critical">Critical (All payloads)</option>
                    </select>
                </div>

                <!-- Custom Payloads -->
                <div class="input-group">
                    <label class="input-label">
                        <i class="fas fa-edit"></i>
                        Custom Payloads (Optional)
                    </label>
                    <textarea class="input-field" id="customPayloads" rows="4" 
                              placeholder="Enter custom payloads, one per line&#10;Example: &#60;script&#62;alert(1)&#60;/script&#62;"></textarea>
                </div>

                <!-- Control Buttons -->
                <div class="btn-group">
                    <button class="btn btn-primary" id="startScan">
                        <i class="fas fa-play"></i> Start Scan
                    </button>
                    <button class="btn btn-secondary" id="stopScan" disabled>
                        <i class="fas fa-stop"></i> Stop Scan
                    </button>
                    <button class="btn btn-danger" id="clearResults">
                        <i class="fas fa-trash"></i> Clear Results
                    </button>
                </div>
            </div>

            <!-- Right Panel: Results -->
            <div class="card">
                <div class="card-title">
                    <i class="fas fa-chart-bar"></i>
                    Scan Results
                </div>

                <!-- Progress Bar -->
                <div id="progressSection" style="display: none;">
                    <div class="progress-container">
                        <div class="progress-bar" id="progressBar"></div>
                    </div>
                    <div class="progress-info">
                        <span id="progressStatus">Initializing...</span>
                        <span id="progressPercent">0%</span>
                    </div>
                </div>

                <!-- Results Tabs -->
                <div class="tabs">
                    <button class="tab active" data-tab="vulnerabilities">Vulnerabilities</button>
                    <button class="tab" data-tab="payloads">Payloads</button>
                    <button class="tab" data-tab="requests">HTTP Requests</button>
                    <button class="tab" data-tab="report">Report</button>
                </div>

                <!-- Vulnerabilities Tab -->
                <div class="tab-content active" id="vulnerabilities">
                    <div class="results-stats" id="statsSection" style="display: none;">
                        <div class="stat stat-critical">
                            <div class="stat-value" id="criticalCount">0</div>
                            <div class="stat-label">Critical</div>
                        </div>
                        <div class="stat stat-high">
                            <div class="stat-value" id="highCount">0</div>
                            <div class="stat-label">High</div>
                        </div>
                        <div class="stat stat-medium">
                            <div class="stat-value" id="mediumCount">0</div>
                            <div class="stat-label">Medium</div>
                        </div>
                        <div class="stat stat-low">
                            <div class="stat-value" id="lowCount">0</div>
                            <div class="stat-label">Low</div>
                        </div>
                    </div>

                    <div class="vuln-list" id="vulnerabilitiesList">
                        <!-- Vulnerabilities will be added here dynamically -->
                        <div style="text-align: center; padding: 50px 20px; color: var(--gray);">
                            <i class="fas fa-search" style="font-size: 48px; margin-bottom: 20px; opacity: 0.5;"></i>
                            <h3>No Scan Results Yet</h3>
                            <p>Configure your scan and click "Start Scan" to begin</p>
                        </div>
                    </div>
                </div>

                <!-- Payloads Tab -->
                <div class="tab-content" id="payloads">
                    <div class="code-block" id="payloadsContent">
                        // Payloads will appear here after scan
                    </div>
                </div>

                <!-- Requests Tab -->
                <div class="tab-content" id="requests">
                    <div class="code-block" id="requestsContent">
                        // HTTP Requests will appear here
                    </div>
                </div>

                <!-- Report Tab -->
                <div class="tab-content" id="report">
                    <div class="code-block" id="reportContent">
                        // Report will be generated here
                    </div>
                    <div class="btn-group">
                        <button class="btn btn-success" id="exportReport">
                            <i class="fas fa-download"></i> Export Report
                        </button>
                        <button class="btn btn-secondary" id="copyReport">
                            <i class="fas fa-copy"></i> Copy Report
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Additional Info -->
        <div class="card">
            <div class="card-title">
                <i class="fas fa-info-circle"></i>
                About XSS Scanner Pro
            </div>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px;">
                <div>
                    <h4 style="margin-bottom: 10px; color: var(--primary);">Features</h4>
                    <ul style="padding-left: 20px; color: var(--dark);">
                        <li>Multiple XSS detection methods</li>
                        <li>Custom payload support</li>
                        <li>Real-time scanning progress</li>
                        <li>Detailed vulnerability reports</li>
                        <li>Export functionality</li>
                    </ul>
                </div>
                <div>
                    <h4 style="margin-bottom: 10px; color: var(--primary);">Payload Types</h4>
                    <ul style="padding-left: 20px; color: var(--dark);">
                        <li>Basic script injection</li>
                        <li>Event handlers (onclick, onload)</li>
                        <li>JavaScript URIs (javascript:)</li>
                        <li>SVG payloads</li>
                        <li>HTML5 vector attacks</li>
                    </ul>
                </div>
                <div>
                    <h4 style="margin-bottom: 10px; color: var(--primary);">Legal Notice</h4>
                    <p style="color: var(--gray); font-size: 14px;">
                        This tool is for educational and authorized security testing only.
                        Always obtain proper authorization before scanning any website.
                        The developers are not responsible for misuse of this tool.
                    </p>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>XSS Scanner Pro v1.0 | Security Research Tool</p>
            <p>Made with <i class="fas fa-heart" style="color: #ef4444;"></i> for the security community</p>
            <div class="footer-links">
                <a href="#"><i class="fab fa-github"></i> GitHub</a>
                <a href="#"><i class="fas fa-book"></i> Documentation</a>
                <a href="#"><i class="fas fa-bug"></i> Report Bug</a>
                <a href="#"><i class="fas fa-envelope"></i> Contact</a>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let isScanning = false;
        let scanProgress = 0;
        let vulnerabilities = [];
        let scanOptions = {
            reflected: true,
            stored: true,
            dom: true,
            blind: false
        };
        let payloads = [];

        // DOM Elements
        const elements = {
            targetUrl: document.getElementById('targetUrl'),
            payloadIntensity: document.getElementById('payloadIntensity'),
            customPayloads: document.getElementById('customPayloads'),
            startScan: document.getElementById('startScan'),
            stopScan: document.getElementById('stopScan'),
            clearResults: document.getElementById('clearResults'),
            progressSection: document.getElementById('progressSection'),
            progressBar: document.getElementById('progressBar'),
            progressStatus: document.getElementById('progressStatus'),
            progressPercent: document.getElementById('progressPercent'),
            vulnerabilitiesList: document.getElementById('vulnerabilitiesList'),
            statsSection: document.getElementById('statsSection'),
            criticalCount: document.getElementById('criticalCount'),
            highCount: document.getElementById('highCount'),
            mediumCount: document.getElementById('mediumCount'),
            lowCount: document.getElementById('lowCount'),
            payloadsContent: document.getElementById('payloadsContent'),
            requestsContent: document.getElementById('requestsContent'),
            reportContent: document.getElementById('reportContent'),
            exportReport: document.getElementById('exportReport'),
            copyReport: document.getElementById('copyReport'),
            notification: document.getElementById('notification'),
            notificationTitle: document.getElementById('notificationTitle'),
            notificationMessage: document.getElementById('notificationMessage'),
            notificationClose: document.getElementById('notificationClose'),
            themeToggle: document.getElementById('themeToggle')
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initializeEventListeners();
            initializeOptions();
            showNotification('Welcome to XSS Scanner Pro', 'Configure your target URL and scan options to begin.', 'info');
        });

        // Event Listeners
        function initializeEventListeners() {
            // Option cards
            document.querySelectorAll('.option-card').forEach(card => {
                card.addEventListener('click', function() {
                    this.classList.toggle('selected');
                    const option = this.dataset.option;
                    scanOptions[option] = !scanOptions[option];
                });
            });

            // Tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.dataset.tab;
                    switchTab(tabId);
                });
            });

            // Control buttons
            elements.startScan.addEventListener('click', startScan);
            elements.stopScan.addEventListener('click', stopScan);
            elements.clearResults.addEventListener('click', clearResults);
            elements.exportReport.addEventListener('click', exportReport);
            elements.copyReport.addEventListener('click', copyReport);
            elements.notificationClose.addEventListener('click', hideNotification);
            elements.themeToggle.addEventListener('click', toggleTheme);

            // Hide notification when clicking outside
            document.addEventListener('click', function(event) {
                if (!elements.notification.contains(event.target)) {
                    hideNotification();
                }
            });
        }

        // Initialize options
        function initializeOptions() {
            // Generate sample payloads
            payloads = generatePayloads();
        }

        // Switch tabs
        function switchTab(tabId) {
            // Update tab buttons
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.toggle('active', tab.dataset.tab === tabId);
            });

            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.toggle('active', content.id === tabId);
            });

            // Generate report if needed
            if (tabId === 'report') {
                generateReport();
            }
        }

        // Start scan
        async function startScan() {
            const targetUrl = elements.targetUrl.value.trim();
            
            if (!targetUrl) {
                showNotification('Error', 'Please enter a target URL', 'danger');
                return;
            }

            if (!isValidUrl(targetUrl)) {
                showNotification('Error', 'Please enter a valid URL', 'danger');
                return;
            }

            // Reset
            isScanning = true;
            scanProgress = 0;
            vulnerabilities = [];
            elements.vulnerabilitiesList.innerHTML = '';

            // Update UI
            elements.startScan.disabled = true;
            elements.stopScan.disabled = false;
            elements.progressSection.style.display = 'block';
            updateProgress('Initializing scan...', 0);

            // Show notification
            showNotification('Scan Started', `Scanning ${targetUrl}`, 'info');

            // Generate payloads based on intensity
            const intensity = elements.payloadIntensity.value;
            let selectedPayloads = getPayloadsByIntensity(intensity);

            // Add custom payloads
            const customPayloadsText = elements.customPayloads.value.trim();
            if (customPayloadsText) {
                const customPayloads = customPayloadsText.split('\n').filter(p => p.trim());
                selectedPayloads = [...selectedPayloads, ...customPayloads];
            }

            // Simulate scanning process
            await simulateScan(targetUrl, selectedPayloads);

            // Scan complete
            isScanning = false;
            elements.startScan.disabled = false;
            elements.stopScan.disabled = true;
            updateProgress('Scan complete!', 100);

            // Show results
            showNotification('Scan Complete', `Found ${vulnerabilities.length} vulnerabilities`, 'success');
            displayResults();
        }

        // Stop scan
        function stopScan() {
            if (isScanning) {
                isScanning = false;
                elements.startScan.disabled = false;
                elements.stopScan.disabled = true;
                updateProgress('Scan stopped by user', scanProgress);
                showNotification('Scan Stopped', 'Scan was stopped manually', 'warning');
            }
        }

        // Clear results
        function clearResults() {
            vulnerabilities = [];
            elements.vulnerabilitiesList.innerHTML = `
                <div style="text-align: center; padding: 50px 20px; color: var(--gray);">
                    <i class="fas fa-search" style="font-size: 48px; margin-bottom: 20px; opacity: 0.5;"></i>
                    <h3>No Scan Results Yet</h3>
                    <p>Configure your scan and click "Start Scan" to begin</p>
                </div>
            `;
            elements.statsSection.style.display = 'none';
            elements.payloadsContent.textContent = '// Payloads will appear here after scan';
            elements.requestsContent.textContent = '// HTTP Requests will appear here';
            elements.reportContent.textContent = '// Report will be generated here';
            showNotification('Results Cleared', 'All scan results have been cleared', 'info');
        }

        // Simulate scanning process
        async function simulateScan(targetUrl, payloads) {
            const totalSteps = payloads.length * 2;
            let currentStep = 0;

            for (const payload of payloads) {
                if (!isScanning) break;

                // Simulate sending request
                currentStep++;
                updateProgress(`Testing payload: ${payload.substring(0, 30)}...`, 
                             (currentStep / totalSteps) * 50);

                // Simulate delay
                await sleep(50);

                // Randomly generate vulnerabilities (for demo)
                if (Math.random() < 0.3) {
                    const vulnerability = createVulnerability(targetUrl, payload);
                    vulnerabilities.push(vulnerability);
                }

                currentStep++;
                updateProgress(`Analyzing response...`, 
                             (currentStep / totalSteps) * 50);

                await sleep(30);
            }

            // Final analysis
            if (isScanning) {
                updateProgress('Analyzing results...', 75);
                await sleep(500);
                updateProgress('Generating report...', 90);
                await sleep(300);
            }
        }

        // Create a vulnerability (demo)
        function createVulnerability(targetUrl, payload) {
            const severity = getRandomSeverity();
            const types = ['Reflected XSS', 'Stored XSS', 'DOM XSS', 'Blind XSS'];
            const type = types[Math.floor(Math.random() * types.length)];
            
            const id = 'VULN-' + Date.now().toString().substring(8) + Math.floor(Math.random() * 1000);
            
            return {
                id,
                type,
                severity,
                payload,
                url: targetUrl + '?test=' + encodeURIComponent(payload),
                description: getVulnerabilityDescription(type, severity),
                impact: getImpactLevel(severity),
                recommendation: getRecommendation(type)
            };
        }

        // Update progress
        function updateProgress(status, percent) {
            scanProgress = percent;
            elements.progressStatus.textContent = status;
            elements.progressPercent.textContent = Math.round(percent) + '%';
            elements.progressBar.style.width = percent + '%';
        }

        // Display results
        function displayResults() {
            if (vulnerabilities.length === 0) {
                elements.vulnerabilitiesList.innerHTML = `
                    <div style="text-align: center; padding: 50px 20px; color: var(--gray);">
                        <i class="fas fa-check-circle" style="font-size: 48px; color: var(--secondary); margin-bottom: 20px;"></i>
                        <h3>No Vulnerabilities Found</h3>
                        <p>The target appears to be secure against XSS attacks</p>
                    </div>
                `;
                elements.statsSection.style.display = 'none';
                return;
            }

            // Update stats
            updateStats();

            // Display vulnerabilities
            elements.vulnerabilitiesList.innerHTML = '';
            vulnerabilities.forEach(vuln => {
                const vulnElement = createVulnerabilityElement(vuln);
                elements.vulnerabilitiesList.appendChild(vulnElement);
            });

            // Update payloads tab
            updatePayloadsTab();

            // Update requests tab
            updateRequestsTab();
        }

        // Update statistics
        function updateStats() {
            const critical = vulnerabilities.filter(v => v.severity === 'critical').length;
            const high = vulnerabilities.filter(v => v.severity === 'high').length;
            const medium = vulnerabilities.filter(v => v.severity === 'medium').length;
            const low = vulnerabilities.filter(v => v.severity === 'low').length;

            elements.criticalCount.textContent = critical;
            elements.highCount.textContent = high;
            elements.mediumCount.textContent = medium;
            elements.lowCount.textContent = low;

            elements.statsSection.style.display = 'flex';
        }

        // Create vulnerability element
        function createVulnerabilityElement(vuln) {
            const div = document.createElement('div');
            div.className = 'vuln-item';
            div.innerHTML = `
                <div class="vuln-header">
                    <div class="vuln-title">
                        <i class="fas fa-bug"></i>
                        ${vuln.type} - ${vuln.id}
                    </div>
                    <div class="vuln-severity severity-${vuln.severity}">
                        ${vuln.severity.toUpperCase()}
                    </div>
                </div>
                <div style="color: var(--gray); margin-bottom: 10px;">
                    <i class="fas fa-link"></i> 
                    <span class="vuln-url">${vuln.url.substring(0, 80)}${vuln.url.length > 80 ? '...' : ''}</span>
                </div>
                <p style="margin-bottom: 15px;">${vuln.description}</p>
                <div class="vuln-details">
                    <strong>Payload:</strong> <span class="vuln-payload">${escapeHtml(vuln.payload)}</span><br><br>
                    <strong>Impact:</strong> ${vuln.impact}<br><br>
                    <strong>Recommendation:</strong> ${vuln.recommendation}
                </div>
            `;
            return div;
        }

        // Update payloads tab
        function updatePayloadsTab() {
            const uniquePayloads = [...new Set(vulnerabilities.map(v => v.payload))];
            elements.payloadsContent.innerHTML = uniquePayloads.map(p => 
                `<span style="color: #ce9178;">"${escapeHtml(p)}"</span>`
            ).join(',\n');
        }

        // Update requests tab
        function updateRequestsTab() {
            const requests = vulnerabilities.map(v => 
                `GET ${v.url}\nUser-Agent: XSS-Scanner/1.0\nAccept: */*\n`
            ).join('\n');
            elements.requestsContent.textContent = requests;
        }

        // Generate report
        function generateReport() {
            const report = `
XSS SCAN REPORT
================
Date: ${new Date().toLocaleString()}
Target: ${elements.targetUrl.value}
Scan Options: ${JSON.stringify(scanOptions, null, 2)}
Payload Intensity: ${elements.payloadIntensity.value}

SUMMARY
-------
Total Vulnerabilities: ${vulnerabilities.length}
Critical: ${vulnerabilities.filter(v => v.severity === 'critical').length}
High: ${vulnerabilities.filter(v => v.severity === 'high').length}
Medium: ${vulnerabilities.filter(v => v.severity === 'medium').length}
Low: ${vulnerabilities.filter(v => v.severity === 'low').length}

VULNERABILITIES
---------------
${vulnerabilities.map(v => `
[${v.severity.toUpperCase()}] ${v.type}
ID: ${v.id}
URL: ${v.url}
Payload: ${v.payload}
Description: ${v.description}
Impact: ${v.impact}
Recommendation: ${v.recommendation}
`).join('\n')}

PAYLOUS USED
------------
${[...new Set(vulnerabilities.map(v => v.payload))].join('\n')}

RECOMMENDATIONS
---------------
1. Implement proper input validation
2. Use output encoding
3. Implement Content Security Policy (CSP)
4. Use HTTP-only cookies
5. Regular security testing

Generated by XSS Scanner Pro
https://github.com/yourusername/xss-scanner
            `;

            elements.reportContent.textContent = report;
        }

        // Export report
        function exportReport() {
            generateReport();
            const report = elements.reportContent.textContent;
            const blob = new Blob([report], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `xss-scan-report-${Date.now()}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('Report Exported', 'Scan report has been downloaded', 'success');
        }

        // Copy report
        function copyReport() {
            generateReport();
            navigator.clipboard.writeText(elements.reportContent.textContent)
                .then(() => showNotification('Copied', 'Report copied to clipboard', 'success'))
                .catch(() => showNotification('Error', 'Failed to copy report', 'danger'));
        }

        // Show notification
        function showNotification(title, message, type = 'info') {
            elements.notificationTitle.textContent = title;
            elements.notificationMessage.textContent = message;
            elements.notification.className = `notification show alert alert-${type}`;
            
            // Auto-hide after 5 seconds
            setTimeout(hideNotification, 5000);
        }

        // Hide notification
        function hideNotification() {
            elements.notification.classList.remove('show');
        }

        // Toggle theme
        function toggleTheme() {
            document.body.classList.toggle('dark-theme');
            const icon = elements.themeToggle.querySelector('i');
            if (document.body.classList.contains('dark-theme')) {
                icon.className = 'fas fa-sun';
                document.body.style.background = '#1a1a1a';
            } else {
                icon.className = 'fas fa-moon';
                document.body.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
            }
        }

        // Utility functions
        function isValidUrl(string) {
            try {
                new URL(string);
                return true;
            } catch (_) {
                return false;
            }
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        function getRandomSeverity() {
            const severities = ['low', 'medium', 'high', 'critical'];
            return severities[Math.floor(Math.random() * severities.length)];
        }

        function getVulnerabilityDescription(type, severity) {
            const descriptions = {
                'Reflected XSS': 'The application reflects user input without proper sanitization.',
                'Stored XSS': 'User input is stored and later displayed without sanitization.',
                'DOM XSS': 'Client-side JavaScript uses user input without sanitization.',
                'Blind XSS': 'Payload is stored and executed when viewed by admin users.'
            };
            return descriptions[type] || 'Cross-site scripting vulnerability detected.';
        }

        function getImpactLevel(severity) {
            const impacts = {
                'critical': 'Account takeover, data theft, complete compromise',
                'high': 'Session hijacking, sensitive data exposure',
                'medium': 'Limited data exposure, defacement',
                'low': 'Minor information disclosure, limited impact'
            };
            return impacts[severity] || 'Unknown impact';
        }

        function getRecommendation(type) {
            const recommendations = {
                'Reflected XSS': 'Implement input validation and output encoding.',
                'Stored XSS': 'Sanitize all user input before storage and display.',
                'DOM XSS': 'Avoid using .innerHTML and use .textContent instead.',
                'Blind XSS': 'Implement proper input validation on all endpoints.'
            };
            return recommendations[type] || 'Implement proper input validation and output encoding.';
        }

        // Payload generation
        function generatePayloads() {
            return [
                '<script>alert(1)</script>',
                '<img src=x onerror=alert(1)>',
                '<svg/onload=alert(1)>',
                '" onmouseover="alert(1)',
                'javascript:alert(1)',
                '<body onload=alert(1)>',
                '<iframe src=javascript:alert(1)>',
                '<input onfocus=alert(1) autofocus>',
                '<details open ontoggle=alert(1)>',
                '<video><source onerror=alert(1)>',
                '<audio src=x onerror=alert(1)>',
                '<form><button formaction=javascript:alert(1)>',
                '<math><maction actiontype="statusline#http://google.com" xlink:href="javascript:alert(1)">',
                '"><script>alert(1)</script>',
                '\'><script>alert(1)</script>',
                '"><img src=x onerror=alert(1)>',
                '\'><img src=x onerror=alert(1)>',
                '${alert(1)}',
                '#{alert(1)}',
                '{{alert(1)}}'
            ];
        }

        function getPayloadsByIntensity(intensity) {
            const allPayloads = generatePayloads();
            const limits = {
                'low': 5,
                'medium': 10,
                'high': 15,
                'critical': allPayloads.length
            };
            return allPayloads.slice(0, limits[intensity] || 10);
        }

        // Add dark theme styles
        const darkThemeStyles = `
            <style>
                body.dark-theme {
                    background: #1a1a1a !important;
                    color: #e0e0e0;
                }
                
                body.dark-theme .card {
                    background: #2d2d2d;
                    color: #e0e0e0;
                }
                
                body.dark-theme .input-field {
                    background: #3d3d3d;
                    border-color: #4d4d4d;
                    color: #e0e0e0;
                }
                
                body.dark-theme .input-field:focus {
                    background: #4d4d4d;
                    border-color: var(--primary);
                }
                
                body.dark-theme .vuln-list,
                body.dark-theme .results-stats {
                    background: #2d2d2d;
                }
                
                body.dark-theme .vuln-item {
                    border-color: #3d3d3d;
                }
                
                body.dark-theme .vuln-details {
                    background: #3d3d3d;
                }
                
                body.dark-theme .code-block {
                    background: #1e1e1e;
                }
                
                body.dark-theme .header h1 {
                    background: linear-gradient(135deg, #ffffff 0%, #a0a0a0 100%);
                    -webkit-background-clip: text;
                }
                
                body.dark-theme .header p {
                    color: #a0a0a0;
                }
            </style>
        `;
        
        document.head.insertAdjacentHTML('beforeend', darkThemeStyles);
    </script>
</body>
</html>